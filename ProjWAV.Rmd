---
title: "ProjWAV"
author: "Beatriz de Faria"
date: "09/12/2020"
output:
  word_document: default
  html_document: default
---

```{r}
library("openxlsx") 
library(ggplot2)
library(RColorBrewer)
library(dplyr)
library(ggpubr)
library(tidyr)
library(hrbrthemes)
library(sf)
library(geobr)
library(factoextra)
library(ade4)
library(vegan)
library(gclus)
library(cluster)
library(FD)
library(ggcorrplot)
```

# Seção 1

```{r}
WS <- read.xlsx ("C:/Users/bia99/OneDrive/Documents/Wikiaves/R/S1/WAVxSPL.xlsx") 
WAV <- read.xlsx ("C:/Users/bia99/OneDrive/Documents/Wikiaves/R/S1/WAV.xlsx") 
SPL <- read.xlsx ("C:/Users/bia99/OneDrive/Documents/Wikiaves/R/S1/SPL.xlsx")
ESP <- read.xlsx ("C:/Users/bia99/OneDrive/Documents/Wikiaves/R/S1/Espécies.xlsx")
dados <- read.xlsx ("C:/Users/bia99/OneDrive/Documents/Wikiaves/R/S1/dados.xlsx")
```

## Representação 1

```{r}
A1 <- hist(WAV$WAVR, 
           plot = FALSE, 
           breaks = c(0,0.2,0.4,0.6,0.8,1.0,1.2,1.4,1.6,1.8,2.0,2.2,2.4,2.6,2.8,3.0,3.2,3.4,3.6,3.8,4.0,4.2,4.4,4.6,4.8,5.0))
A1$density = A1$counts/sum(A1$counts)*100

B1 <- hist(SPL$SPLR, 
           plot = FALSE, 
           breaks = c(0,0.2,0.4,0.6,0.8,1.0,1.2,1.4,1.6,1.8,2.0,2.2,2.4,2.6,2.8,3.0,3.2,3.4,3.6,3.8,4.0,4.2,4.4,4.6,4.8,5.0))
B1$density = B1$counts/sum(B1$counts)*100

C1 <- hist (WS$WAV2R, 
            plot = FALSE, 
            breaks = c(0,0.2,0.4,0.6,0.8,1.0,1.2,1.4,1.6,1.8,2.0,2.2,2.4,2.6,2.8,3.0,3.2,3.4,3.6,3.8,4.0,4.2,4.4,4.6,4.8,5.0))
C1$density = C1$counts/sum(C1$counts)*100

A2 <- hist(WAV$WAVE, 
           plot = FALSE, 
           breaks = c(0,0.12,0.24,0.36,0.48,0.60,0.72,0.84,0.96,1.08,1.20,1.32,1.44,1.56,1.68,1.80,1.92,2.04,2.16,2.28,2.40,2.52,2.64,2.76,2.88,3.00)) 
A2$density = A2$counts/sum(A2$counts)*100

B2 <- hist(SPL$SPLE, 
           plot = FALSE, 
           breaks = c(0,0.12,0.24,0.36,0.48,0.60,0.72,0.84,0.96,1.08,1.20,1.32,1.44,1.56,1.68,1.80,1.92,2.04,2.16,2.28,2.40,2.52,2.64,2.76,2.88,3.00))
B2$density = B2$counts/sum(B2$counts)*100

C2 <- hist(WS$WAV2E, 
           plot = FALSE,
           breaks = c(0,0.12,0.24,0.36,0.48,0.60,0.72,0.84,0.96,1.08,1.20,1.32,1.44,1.56,1.68,1.80,1.92,2.04,2.16,2.28,2.40,2.52,2.64,2.76,2.88,3.00)) 
C2$density = C2$counts/sum(C2$counts)*100

A3 <- hist(ESP$WAV, 
           plot = FALSE, 
           breaks = c(0,0.16,0.32,0.48,0.64,0.8,0.96,1.12,1.28,1.44,1.60,1.76,1.92,2.08,2.24,2.40,2.56,2.72,2.88,3.04,3.20,3.36,3.52,3.68,3.84,4.00))
A3$density = A3$counts/sum(A3$counts)*100

B3 <- hist(ESP$SPL, 
           plot = FALSE, 
           breaks = c(0,0.16,0.32,0.48,0.64,0.8,0.96,1.12,1.28,1.44,1.60,1.76,1.92,2.08,2.24,2.40,2.56,2.72,2.88,3.04,3.20,3.36,3.52,3.68,3.84,4.00))
B3$density = B3$counts/sum(B3$counts)*100

C3 <- hist(ESP$WAV2, 
           plot = FALSE,
           breaks = c(0,0.16,0.32,0.48,0.64,0.8,0.96,1.12,1.28,1.44,1.60,1.76,1.92,2.08,2.24,2.40,2.56,2.72,2.88,3.04,3.20,3.36,3.52,3.68,3.84,4.00))
C3$density = C3$counts/sum(C3$counts)*100
```

```{r}
plot(A1, col=rgb(0,0,1,1/2),
     main = " ",
     xlab = "Número de Registros (Log10)",
     ylab = "Frequência Relativa (%)",
     freq = FALSE,
     ylim = c(0,20),
     xlim=c(0,5))
plot(B1, col=rgb(1,0,0,1/2), freq = FALSE, add=T) 
plot(C1, col=rgb(0,1,0,1/2), freq = FALSE, add=T)
legend("topright", c("Wikiaves", "SpeciesLink","Wikiaves 2"), col=c(rgb(0,0,1,1/2),col=rgb(1,0,0,1/2) ,rgb(0,1,0,1/2) ), lwd=5, box.col = "white")
```

```{r}
plot(A2, col=rgb(0,0,1,1/2),
     main = " ",
     xlab = "Número de Espécies (Log10)",
     ylab = "Frequência Relativa (%)",
     freq = FALSE,
     ylim = c(0,25),
     xlim=c(0,3))
plot(B2, col=rgb(1,0,0,1/2), freq = FALSE, add=T) 
plot(C2, col=rgb(0,1,0,1/2), freq = FALSE, add=T)
legend("top", c("Wikiaves", "SpeciesLink","Wikiaves 2"), col=c(rgb(0,0,1,1/2),col=rgb(1,0,0,1/2) ,rgb(0,1,0,1/2) ), lwd=5, box.col = "white")
```

```{r}
plot(A3, col=rgb(0,0,1,1/2),
     main = " ",
     xlab = "Número de Registros por Espécie (Log10)",
     ylab = "Frequência Relativa (%)",
     freq = FALSE,
     ylim = c(0,20),
     xlim=c(0,4))
plot(B3, col=rgb(1,0,0,1/2), freq = FALSE, add=T) 
plot(C3, col=rgb(0,1,0,1/2), freq = FALSE, add=T)
legend("topright", c("Wikiaves", "SpeciesLink","Wikiaves 2"), col=c(rgb(0,0,1,1/2),col=rgb(1,0,0,1/2) ,rgb(0,1,0,1/2) ), lwd=5, box.col = "white")
```

## Representação 2

```{r}
ggplot(dados, aes(x = R, fill = L, colour = L))+
  scale_colour_manual(values = c("red", "blue", "green")) +
  scale_fill_manual(values = c("red", "blue", "green")) +
  geom_density(alpha = 0.2)+
  labs(x = "Quantidade de Registros (Log10)",
       y = "Densidade")+
  theme_classic()
```

```{r}
ggplot(dados, aes(x = E, fill = L, colour = L))+
  scale_colour_manual(values = c("red", "blue", "green")) +
  scale_fill_manual(values = c("red", "blue", "green")) +
  geom_density(alpha = 0.2)+
  labs(x = "Quantidade de Espécies (Log10)",
       y = "Densidade")+
  theme_classic()
```

```{r}
ggplot(dados, aes(x = RE, fill = L2, colour = L2))+
  scale_colour_manual(values = c("red", "blue", "green")) +
  scale_fill_manual(values = c("red", "blue", "green")) +
  geom_density(alpha = 0.2)+
  labs(x = "Quantidade de Registros (Log10)",
       y = "Densidade")+
  theme_classic()
```

## Representação 3

```{r}
y1 <- A1$density
x1 <- c()
x1[1] <- 0.1
for (i in 1:24){
  x1[i+1] = x1[i]+0.2
}


y2 <- B1$density
x2 <- c()
x2[1] <- 0.1
for (i in 1:24){
  x2[i+1] = x2[i]+0.2
}


y3 <- C1$density
x3 <- c()
x3[1] <- 0.1
for (i in 1:24){
  x3[i+1] = x3[i]+0.2
}

A <- c()

for (i in 1:25){
  A[i] = "WAV (N = 631)"
}
for (i in 26:50){
  A[i] = "SPL (N = 174)"
}
for (i in 51:75){
  A[i] = "WAV 2 (N = 173)"
}

B <- c()

for (i in 1:25){
  B[i] = x1[i]
}

for(i in 26:50){
  B[i] = x2[i-25]
}
for(i  in 51:75){
  B[i] = x3[i-50]
}

C<- c()

for (i in 1:25){
  C[i] = y1[i]
}

for(i in 26:50){
  C[i] = y2[i-25]
}
for(i  in 51:75){
  C[i] = y3[i-50]
}

dados <- data.frame(L = A, x = B, y = C)

ggplot(dados, aes(x = x, y = C, group = L, colour = L))+
  scale_colour_manual(values = c("red", "blue", "green")) +
  stat_smooth(method = lm, formula = y ~ poly(x, 15),se = FALSE, fullrange = TRUE)+
  labs(x = "Número de Registros (Log10)",
       y = "Frequência Relativa (%)",
       colour = " ")+
  theme_classic()
```


```{r}
y1 <- A2$density
x1 <- c()
x1[1] <- 0.1
for (i in 1:24){
  x1[i+1] = x1[i]+0.12
}

y2 <- B2$density
x2 <- c()
x2[1] <- 0.1
for (i in 1:24){
  x2[i+1] = x2[i]+0.12
}

y3 <- C2$density
x3 <- c()
x3[1] <- 0.1
for (i in 1:24){
  x3[i+1] = x3[i]+0.12
}

A <- c()

for (i in 1:25){
  A[i] = "WAV (N = 631)"
}
for (i in 26:50){
  A[i] = "SPL (N = 174)"
}
for (i in 51:75){
  A[i] = "WAV 2 (N = 173)"
}

B <- c()

for (i in 1:25){
  B[i] = x1[i]
}

for(i in 26:50){
  B[i] = x2[i-25]
}
for(i  in 51:75){
  B[i] = x3[i-50]
}

C<- c()

for (i in 1:25){
  C[i] = y1[i]
}

for(i in 26:50){
  C[i] = y2[i-25]
}
for(i  in 51:75){
  C[i] = y3[i-50]
}

dados <- data.frame(L = A, x = B, y = C)

ggplot(dados, aes(x = x, y = C, group = L, colour = L))+
  scale_colour_manual(values = c("red", "blue", "green")) +
  stat_smooth(method = lm, formula = y ~ poly(x, 15),se = FALSE, fullrange = TRUE)+
  labs(x = "Número de Espécies (Log10)",
       y = "Frequência Relativa (%)",
       colour = " ")+
  theme_classic()
```

```{r}
y1 <- A3$density
x1 <- c()
x1[1] <- 0.1
for (i in 1:24){
  x1[i+1] = x1[i]+0.16
}

y2 <- B3$density
x2 <- c()
x2[1] <- 0.1
for (i in 1:24){
  x2[i+1] = x2[i]+0.16
}

y3 <- C3$density
x3 <- c()
x3[1] <- 0.1
for (i in 1:24){
  x3[i+1] = x3[i]+0.16
}


A <- c()

for (i in 1:25){
  A[i] = "WAV (S = 790)"
}
for (i in 26:50){
  A[i] = "SPL (S = 661)"
}
for (i in 51:75){
  A[i] = "WAV 2 (S = 779)"
}

B <- c()

for (i in 1:25){
  B[i] = x1[i]
}

for(i in 26:50){
  B[i] = x2[i-25]
}
for(i  in 51:75){
  B[i] = x3[i-50]
}

C<- c()

for (i in 1:25){
  C[i] = y1[i]
}

for(i in 26:50){
  C[i] = y2[i-25]
}
for(i  in 51:75){
  C[i] = y3[i-50]
}

dados <- data.frame(L = A, x = B, y = C)

ggplot(dados, aes(x = x, y = C, group = L, colour = L))+
  scale_colour_manual(values = c("red", "blue", "green")) +
  stat_smooth(method = lm, formula = y ~ poly(x, 15),se = FALSE, fullrange = TRUE)+
  labs(x = "Número de Registros por Espécie (Log10)",
       y = "Frequência Relativa (%)",
       colour = " ")+
  theme_classic()
```

```{r}
rm(list=ls())
```

# Seção 2

```{r}
FE <- read.xlsx ("C:/Users/bia99/OneDrive/Documents/Wikiaves/R/S2/FE.xlsx")
dados <- read.xlsx ("C:/Users/bia99/OneDrive/Documents/Wikiaves/R/S2/Dados.xlsx")
```

## Representação 1

```{r}
WAL <- hist(FE$WAVAL, 
            plot = FALSE, 
            breaks = c(0,72,144,216,288,360,432,504,576,648,720,792,864,936,1008,1080,1152,1224,1296,1368,1440,1512,1584,1656,1782,1800))
WAL$density = WAL$counts/sum(WAL$counts)*100

SAL <- hist(FE$SPLAL, 
            plot = FALSE, 
            breaks = c(0,72,144,216,288,360,432,504,576,648,720,792,864,936,1008,1080,1152,1224,1296,1368,1440,1512,1584,1656,1782,1800))
SAL$density = SAL$counts/sum(SAL$counts)*100

WAR <- hist(FE$WAVAR, 
            plot = FALSE, 
            breaks = c(0,0.16,0.32,0.48,0.64,0.8,0.96,1.12,1.28,1.44,1.60,1.76,1.92,2.08,2.24,2.40,2.56,2.72,2.88,3.04,3.20,3.36,3.52,3.68,3.84,4.00))
WAR$density = WAR$counts/sum(WAR$counts)*100

SAR <- hist(FE$SPLAR, 
            plot = FALSE, 
            breaks = c(0,0.16,0.32,0.48,0.64,0.8,0.96,1.12,1.28,1.44,1.60,1.76,1.92,2.08,2.24,2.40,2.56,2.72,2.88,3.04,3.20,3.36,3.52,3.68,3.84,4.00))
SAR$density = SAR$counts/sum(SAR$counts)*100

WPOP <- hist(FE$WAVPOP, 
             plot = FALSE, 
             breaks = c(2,2.22,2.44,2.66,2.88,3.1,3.32,3.54,3.76,3.98,4.2,4.42,4.64,4.86,5.08,5.3,5.52,5.74,5.96,6.18,6.4,6.62,6.84,7.06,7.28,7.5))
WPOP$density = WPOP$counts/sum(WPOP$counts)*100

SPOP <- hist(FE$SPLPOP, 
             plot = FALSE, 
             breaks = c(2,2.22,2.44,2.66,2.88,3.1,3.32,3.54,3.76,3.98,4.2,4.42,4.64,4.86,5.08,5.3,5.52,5.74,5.96,6.18,6.4,6.62,6.84,7.06,7.28,7.5))
SPOP$density = SPOP$counts/sum(SPOP$counts)*100

WLA <- hist(FE$WAVLA, 
            plot = FALSE, 
            breaks = c(-25.5,-25.26,-25.02,-24.78,-24.54,-24.3,-24.06,-23.82,-23.58,-23.34,-23.1,-22.86,-22.62,-22.38,-22.14,-21.9,-21.66,-21.42,-21.18,-20.94,-20.7,-20.46,-20.22,-19.98,-19.74,-19,5))
WLA$density = WLA$counts/sum(WLA$counts)*100

SLA <- hist(FE$SPLLA, 
            plot = FALSE, 
            breaks = c(-25.5,-25.26,-25.02,-24.78,-24.54,-24.3,-24.06,-23.82,-23.58,-23.34,-23.1,-22.86,-22.62,-22.38,-22.14,-21.9,-21.66,-21.42,-21.18,-20.94,-20.7,-20.46,-20.22,-19.98,-19.74,-19,5))
SLA$density = SLA$counts/sum(SLA$counts)*100

WLO <- hist(FE$WAVLO, 
            plot = FALSE, 
            breaks = c(-55,-54.48,-53.96,-53.44,-52.92,-52.4,-51.88,-51.36,-50.84,-50.32,-49.8,-49.28,-48.76,-48.24,-47.72,-47.2,-46.68,-46.16,-45.64,-45.12,-44.6,-44.08,-43.56,-43.04,-42.52,-42))
WLO$density = WLO$counts/sum(WLO$counts)*100

SLO <- hist(FE$SPLLO, 
            plot = FALSE, 
            breaks = c(-55,-54.48,-53.96,-53.44,-52.92,-52.4,-51.88,-51.36,-50.84,-50.32,-49.8,-49.28,-48.76,-48.24,-47.72,-47.2,-46.68,-46.16,-45.64,-45.12,-44.6,-44.08,-43.56,-43.04,-42.52,-42))
SLO$density = SLO$counts/sum(SLO$counts)*100
```

### Altitude

```{r}
plot(WAL, col=rgb(0,0,1,1/2),
     main = " ",
     xlab = "Altitude (m)",
     ylab = "Frequência Relativa (%)",
     freq = FALSE,
     #ylim = c(0,1),
     xlim=c(0,1800))
plot(SAL, col=rgb(1,0,0,1/2), freq = FALSE, add=T) 
legend("topright", c("Wikiaves", "SpeciesLink"), col=c(rgb(0,0,1,1/2),col=rgb(1,0,0,1/2) ), lwd=5, box.col = "white")
```

### Área

```{r}
plot(WAR, col=rgb(0,0,1,1/2),
     main = " ",
     xlab = "Área (Log10(Km^2))",
     ylab = "Frequência Relativa (%)",
     freq = FALSE,
     ylim = c(0,20),
     xlim=c(0,4))
plot(SAR, col=rgb(1,0,0,1/2), freq = FALSE, add=T) 
legend("topright", c("Wikiaves", "SpeciesLink"), col=c(rgb(0,0,1,1/2),col=rgb(1,0,0,1/2) ), lwd=5, box.col = "white")
```

### População

```{r}
plot(WPOP, col=rgb(0,0,1,1/2),
     main = " ",
     xlab = "População (Log10)",
     ylab = "Frequência Relativa (%)",
     freq = FALSE,
     ylim = c(0,20),
     xlim=c(2,7.5))
plot(SPOP, col=rgb(1,0,0,1/2), freq = FALSE, add=T)
legend("topright", c("Wikiaves", "SpeciesLink"), col=c(rgb(0,0,1,1/2),col=rgb(1,0,0,1/2) ), lwd=5, box.col = "white")
```

### Latitude

```{r}
plot(WLA, col=rgb(0,0,1,1/2),
     main = " ",
     xlab = "Latitude (°)",
     ylab = "Frequência Relativa (%)",
     freq = FALSE,
     ylim = c(0,15),
     xlim=c(-25.5,-19.5))
plot(SLA, col=rgb(1,0,0,1/2), freq = FALSE, add=T)
legend("topright", c("Wikiaves", "SpeciesLink"), col=c(rgb(0,0,1,1/2),col=rgb(1,0,0,1/2) ), lwd=5, box.col = "white")
```

### Longitude

```{r}
plot(WLO, col=rgb(0,0,1,1/2),
     main = " ",
     xlab = "Longitude (°)",
     ylab = "Frequência Relativa (%)",
     freq = FALSE,
     ylim = c(0,20),
     xlim=c(-55,-42))
plot(SLO, col=rgb(1,0,0,1/2), freq = FALSE, add=T)
legend("topright", c("Wikiaves", "SpeciesLink"), col=c(rgb(0,0,1,1/2),col=rgb(1,0,0,1/2) ), lwd=5, box.col = "white")
```

## Representação 2

### Altitude

```{r}
ggplot(dados, aes(x = Altitude, fill = L, colour = L))+
        scale_colour_manual(values = c("red", "blue", "green")) +
        scale_fill_manual(values = c("red", "blue", "green")) +
        geom_density(alpha = 0.2)+
        labs(x = "Altitude (m)",
             y = "Densidade")+
        theme_classic()
```

### Área

```{r}
ggplot(dados, aes(x = Área, fill = L, colour = L))+
        scale_colour_manual(values = c("red", "blue", "green")) +
        scale_fill_manual(values = c("red", "blue", "green")) +
        geom_density(alpha = 0.2)+
        labs(x = "Área (Log10(km^2))",
             y = "Densidade")+
        theme_classic()
```

### População

```{r}
ggplot(dados, aes(x = População, fill = L, colour = L))+
        scale_colour_manual(values = c("red", "blue", "green")) +
        scale_fill_manual(values = c("red", "blue", "green")) +
        geom_density(alpha = 0.2)+
        labs(x = "População (log10)",
             y = "Densidade")+
        theme_classic()
```

### Latitude

```{r}
ggplot(dados, aes(x = Latitude, fill = L, colour = L))+
        scale_colour_manual(values = c("red", "blue", "green")) +
        scale_fill_manual(values = c("red", "blue", "green")) +
        geom_density(alpha = 0.2)+
        labs(x = "Latitude (º)",
             y = "Densidade")+
        theme_classic()
```

### Longitude

```{r}
ggplot(dados, aes(x = Longitude, fill = L, colour = L))+
        scale_colour_manual(values = c("red", "blue", "green")) +
        scale_fill_manual(values = c("red", "blue", "green")) +
        geom_density(alpha = 0.2)+
        labs(x = "Longitude (º)",
             y = "Densidade")+
        theme_classic()

```

## Representação 3

### Altitude

```{r}
y1 <- WAL$density
x1 <- c()
x1[1] <- 36
for (i in 1:24){
  x1[i+1] = x1[i]+72
}

y2 <- SAL$density
x2 <- c()
x2[1] <- 36
for (i in 1:24){
  x2[i+1] = x2[i]+72
}

A <- c()

for (i in 1:25){
  A[i] = "WAV (N = 631)"
}
for (i in 26:50){
  A[i] = "SPL (N = 174)"
}

B <- c()

for (i in 1:25){
  B[i] = x1[i]
}

for(i in 26:50){
  B[i] = x2[i-25]
}

C<- c()

for (i in 1:25){
  C[i] = y1[i]
}

for(i in 26:50){
  C[i] = y2[i-25]
}

dados <- data.frame(Legenda = A, x = B, y = C)

ggplot(dados, aes(x = x, y = C, group = Legenda, colour = Legenda))+
  scale_colour_manual(values = c("red", "blue")) +
  stat_smooth(method = lm, formula = y ~ poly(x, 15),se = FALSE, fullrange = TRUE)+
  labs(x = "Altitude (m)",
       y = "Frequência Relativa %",
       colour = " ")+
  theme_classic()
```

### Área

```{r}
y1 <- WAR$density
x1 <- c()
x1[1] <- 0.08
for (i in 1:24){
  x1[i+1] = x1[i]+0.16
}

y2 <- SAR$density
x2 <- c()
x2[1] <- 0.08
for (i in 1:24){
  x2[i+1] = x2[i]+0.16
}

A <- c()

for (i in 1:25){
  A[i] = "WAV (N = 631)"
}
for (i in 26:50){
  A[i] = "SPL (N = 174)"
}

B <- c()

for (i in 1:25){
  B[i] = x1[i]
}

for(i in 26:50){
  B[i] = x2[i-25]
}

C<- c()

for (i in 1:25){
  C[i] = y1[i]
}

for(i in 26:50){
  C[i] = y2[i-25]
}

dados <- data.frame(Legenda = A, x = B, y = C)

ggplot(dados, aes(x = x, y = C, group = Legenda, colour = Legenda))+
  scale_colour_manual(values = c("red", "blue")) +
  stat_smooth(method = lm, formula = y ~ poly(x, 15),se = FALSE, fullrange = TRUE)+
  labs(x = "Área (Log10(km^2))",
       y = "Frequência Relativa (%)",
       colour = " ")+
  theme_classic()
```

### População

```{r}
y1 <- WPOP$density
x1 <- c()
x1[1] <- 2.11
for (i in 1:24){
  x1[i+1] = x1[i]+0.22
}

y2 <- SPOP$density
x2 <- c()
x2[1] <- 2.11
for (i in 1:24){
  x2[i+1] = x2[i]+0.22
}

A <- c()

for (i in 1:25){
  A[i] = "WAV (N = 631)"
}
for (i in 26:50){
  A[i] = "SPL (N = 174)"
}

B <- c()

for (i in 1:25){
  B[i] = x1[i]
}

for(i in 26:50){
  B[i] = x2[i-25]
}

C<- c()

for (i in 1:25){
  C[i] = y1[i]
}

for(i in 26:50){
  C[i] = y2[i-25]
}

dados <- data.frame(Legenda = A, x = B, y = C)

ggplot(dados, aes(x = x, y = C, group = Legenda, colour = Legenda))+
  scale_colour_manual(values = c("red", "blue")) +
  stat_smooth(method = lm, formula = y ~ poly(x, 15),se = FALSE, fullrange = TRUE)+
  labs(x = "Número de habitantes (Log10)",
       y = "Frequência Relativa (%)",
       colour = " ")+
  theme_classic()
```

### Latitude

```{r}
y1 <- WLA$density
x1 <- c()
x1[1] <- -25.38
for (i in 1:24){
  x1[i+1] = x1[i]+0.24
}

y2 <- SLA$density
x2 <- c()
x2[1] <- -25.38
for (i in 1:24){
  x2[i+1] = x2[i]+0.24
}

A <- c()

for (i in 1:25){
  A[i] = "WAV (N = 631)"
}
for (i in 26:50){
  A[i] = "SPL (N = 174)"
}

B <- c()

for (i in 1:25){
  B[i] = x1[i]
}

for(i in 26:50){
  B[i] = x2[i-25]
}

C<- c()

for (i in 1:25){
  C[i] = y1[i]
}

for(i in 26:50){
  C[i] = y2[i-25]
}

dados <- data.frame(Legenda = A, x = B, y = C)

ggplot(dados, aes(x = x, y = C, group = Legenda, colour = Legenda))+
  scale_colour_manual(values = c("red", "blue")) +
  stat_smooth(method = lm, formula = y ~ poly(x, 15),se = FALSE, fullrange = TRUE)+
  labs(x = "Latitude (º)",
       y = "Frequência Relativa (%)",
       colour = " ")+
  theme_classic()
```

### Longitude

```{r}
y1 <- WLO$density
x1 <- c()
x1[1] <- -54.64
for (i in 1:24){
  x1[i+1] = x1[i]+0.72
}

y2 <- SLO$density
x2 <- c()
x2[1] <- -54.64
for (i in 1:24){
  x2[i+1] = x2[i]+0.72
}

A <- c()

for (i in 1:25){
  A[i] = "WAV (N = 631)"
}
for (i in 26:50){
  A[i] = "SPL (N = 174)"
}

B <- c()

for (i in 1:25){
  B[i] = x1[i]
}

for(i in 26:50){
  B[i] = x2[i-25]
}

C<- c()

for (i in 1:25){
  C[i] = y1[i]
}

for(i in 26:50){
  C[i] = y2[i-25]
}

dados <- data.frame(Legenda = A, x = B, y = C)

ggplot(dados, aes(x = x, y = C, group = Legenda, colour = Legenda))+
  scale_colour_manual(values = c("red", "blue")) +
  stat_smooth(method = lm, formula = y ~ poly(x, 15),se = FALSE)+
  labs(x = "Longitude (º)",
       y = "Frequência Relativa (%)",
       colour = " ")+
  theme_classic()
```


## Representação 3

```{r}
rm(list=ls())
```
# Seção 3

```{r}
AL <- read.xlsx ("C:/Users/bia99/OneDrive/Documents/Wikiaves/R/S3/Altitude.xlsx")
AR <- read.xlsx ("C:/Users/bia99/OneDrive/Documents/Wikiaves/R/S3/Area.xlsx")
POP <- read.xlsx ("C:/Users/bia99/OneDrive/Documents/Wikiaves/R/S3/Populacao.xlsx")
LA <- read.xlsx ("C:/Users/bia99/OneDrive/Documents/Wikiaves/R/S3/Latitude.xlsx")
LO <- read.xlsx ("C:/Users/bia99/OneDrive/Documents/Wikiaves/R/S3/Longitude.xlsx")
dados <- read.xlsx ("C:/Users/bia99/OneDrive/Documents/Wikiaves/R/S3/Auxiliar.xlsx")
```

## Estatísticas 

### Altitude

```{r}
REW <- lm(WAVRAL~ALWAVR, data = dados)
RES <- lm(SPLRAL~ALSPLR, data = dados)
RE <- lm(WAV2RAL~ALWAV2R, data = dados)
```

#### Registros Wikiaves

```{r}
summary(REW)
```

#### Registros SpeciesLink

```{r}
summary(RES) 
```

#### Registros Wikiaves 2

```{r}
summary(RE)
```

```{r}
REW <- lm(WAVRAR~ARWAVR, data = dados)
RES <- lm(SPLRAR~ARSPLR, data = dados)
RE <- lm(WAV2RAR~ARWAV2R, data = dados)
```

#### Espécies Wikiaves

```{r}
summary(REW)
```

#### Espécies SpeciesLink

```{r}
summary(RES) 
```

#### Espécies Wikiaves 2

```{r}
summary(RE)
```

### Área

```{r}
REW <- lm(WAVRAR~ARWAVR, data = dados)
RES <- lm(SPLRAR~ARSPLR, data = dados)
RE <- lm(WAV2RAR~ARWAV2R, data = dados)
```

#### Registros Wikiaves

```{r}
summary(REW)
```

#### Registros SpeciesLink

```{r}
summary(RES) 
```

#### Registros Wikiaves 2

```{r}
summary(RE)
```

```{r}
REW <- lm(WAVEAR~ARWAVE, data = dados)
RES <- lm(SPLEAR~ARSPLE, data = dados)
RE <- lm(WAV2EAR~ARWAV2E, data = dados)
```

#### Espécies Wikiaves

```{r}
summary(REW)
```

#### Espécies SpeciesLink

```{r}
summary(RES) 
```

#### Espécies Wikiaves 2

```{r}
summary(RE)
```


### População

```{r}
REW <- lm(WAVRP~PWAVR, data = dados)
RES <- lm(SPLRP~PSPLR, data = dados)
RE <- lm(WAV2RP~PWAV2R, data = dados)
```

#### Registros Wikiaves

```{r}
summary(REW)
```

#### Registros SpeciesLink

```{r}
summary(RES) 
```

#### Registros Wikiaves 2

```{r}
summary(RE)
```

```{r}
REW <- lm(WAVRE~PWAVE, data = dados)
RES <- lm(SPLEP~PSPLE, data = dados)
RE <- lm(WAV2EP~PWAV2E, data = dados)
```

#### Espécies Wikiaves

```{r}
summary(REW)
```

#### Espécies SpeciesLink

```{r}
summary(RES) 
```

#### Espécies Wikiaves 2

```{r}
summary(RE)
```


### Latitude

```{r}
REW <- lm(WAVRLA~LAWAVR, data = dados)
RES <- lm(SPLRLA~LASPLR, data = dados)
RE <- lm(WAV2RLA~LAWAV2R, data = dados)
```


#### Registros Wikiaves

```{r}
summary(REW)
```

#### Registros SpeciesLink

```{r}
summary(RES) 
```

#### Registros Wikiaves 2

```{r}
summary(RE)
```

```{r}
REW <- lm(WAVELA~LAWAVE, data = dados)
RES <- lm(SPLELA~LASPLE, data = dados)
RE <- lm(WAV2ELA~LAWAV2E, data = dados)
```

#### Espécies Wikiaves

```{r}
summary(REW)
```

#### Espécies SpeciesLink

```{r}
summary(RES) 
```

#### Espécies Wikiaves 2

```{r}
summary(RE)
```

### Longitude

```{r}
REW <- lm(WAVRLO~LOWAVR, data = dados)
RES <- lm(SPLRLO~LOSPLR, data = dados)
RE <- lm(WAV2RLO~LOWAV2R, data = dados)
```

#### Registros Wikiaves

```{r}
summary(REW)
```

#### Registros SpeciesLink

```{r}
summary(RES) 
```

#### Registros Wikiaves 2

```{r}
summary(RE)
```

```{r}
REW <- lm(WAVELO~LOWAVE, data = dados)
RES <- lm(SPLELO~LOSPLE, data = dados)
RE <- lm(WAV2ELO~LOWAV2E, data = dados)
```

#### Espécies Wikiaves

```{r}
summary(REW)
```

#### Espécies SpeciesLink

```{r}
summary(RES) 
```

#### Espécies Wikiaves 2

```{r}
summary(RE)
```

## Representação 1.1.

### Altitude

#### Registros

```{r}
gráfico <- ggplot(AL, aes(x = FR, y = R, colour = L1))+
  geom_point()+
  scale_colour_manual(values = c("red", "blue", "green")) +
  stat_smooth(method = "lm",
              se = FALSE,
              fullrange = TRUE,
              size = 1)+
  labs( x ="Altitude (m)",
        y =  "Número de Registros (Log10)",
        colour = " ")+
  #guides(colour=FALSE)+
  theme_classic()

REW <- lm(WAVRAL~ALWAVR, data = dados)
RES <- lm(SPLRAL~ALSPLR, data = dados)
RE <- lm(WAV2RAL~ALWAV2R, data = dados)

R1 <- resid(REW)
R2 <- resid(RES)
R3 <- resid(RE)


resíduos <- ggplot()+
  geom_histogram(aes (x = R1,
                      y = stat(count) / sum(count)*100, 
                      fill = I("blue"),
                      col = I("black"),
                      alpha = I(.5)),
                 bins = 25)+
  geom_histogram(aes (x = R2,
                      y = stat(count) / sum(count)*100, 
                      fill = I("red"),
                      col = I("black"),
                      alpha = I(.5)),
                 bins = 25)+
  geom_histogram(aes (x = R3,
                      y = stat(count) / sum(count)*100, 
                      fill = I("green"),
                      col = I("black"),
                      alpha = I(.5)),
                 bins = 25)+
  labs(y = "Frequência Relativa (%)",
       x = "Resíduos") +
  theme_classic()

ggarrange(gráfico,resíduos,  ncol = 2, nrow = 1, common.legend = TRUE, legend = "right")
```

#### Espécies

```{r}
gráfico <- ggplot(AL, aes(x = FE, y = E, color = L2))+
  geom_point()+
  scale_colour_manual(values = c("red", "blue", "green")) +
  stat_smooth(method = "lm",
              se = FALSE,
              fullrange = TRUE,
              size = 1)+
  labs( x = "Altitude (m)",
        y = "Número de Espécies (Log10)",
        colour = " ")+
  theme_classic()

REW <- lm(WAVEAL~ALWAVE, data = dados)
RES <- lm(SPLEAL~ALSPLE, data = dados)
RE <- lm(WAV2EAL~ALWAV2E, data = dados)

R1 <- resid(REW)
R2 <- resid(RES)
R3 <- resid(RE)

resíduos <- ggplot()+
  geom_histogram(aes (x = R1,
                      y = stat(count) / sum(count)*100, 
                      fill = I("blue"),
                      col = I("black"),
                      alpha = I(.5)),
                 bins = 25)+
  geom_histogram(aes (x = R2,
                      y = stat(count) / sum(count)*100, 
                      fill = I("red"),
                      col = I("black"),
                      alpha = I(.5)),
                 bins = 25)+
  geom_histogram(aes (x = R3,
                      y = stat(count) / sum(count)*100, 
                      fill = I("green"),
                      col = I("black"),
                      alpha = I(.5)),
                 bins = 25)+
  labs(y = "Frequência Relativa (%)",
       x = "Resíduos") +
  theme_classic()

ggarrange(gráfico,resíduos,  ncol = 2, nrow = 1, common.legend = TRUE, legend = "right")
```

### Área

#### Registros

```{r}
gráfico <- ggplot(AR, aes(x = FR, y = R, color = L1))+
  geom_point()+
  scale_colour_manual(values = c("red", "blue", "green")) +
  stat_smooth(method = "lm",
              se = FALSE,
              fullrange = TRUE,
              size = 1)+
  labs( x ="Área (Log10(Km^2))",
        y =  "Número de Registros (Log10)",
        colour = " ")+
  theme_classic()

REW <- lm(WAVRAR~ARWAVR, data = dados)
RES <- lm(SPLRAR~ARSPLR, data = dados)
RE <- lm(WAV2RAR~ARWAV2R, data = dados)

R1 <- resid(REW)
R2 <- resid(RES)
R3 <- resid(RE)

resíduos <- ggplot()+
  geom_histogram(aes (x = R1,
                      y = stat(count) / sum(count)*100, 
                      fill = I("blue"),
                      col = I("black"),
                      alpha = I(.5)),
                 bins = 25)+
  geom_histogram(aes (x = R2,
                      y = stat(count) / sum(count)*100, 
                      fill = I("red"),
                      col = I("black"),
                      alpha = I(.5)),
                 bins = 25)+
  geom_histogram(aes (x = R3,
                      y = stat(count) / sum(count)*100, 
                      fill = I("green"),
                      col = I("black"),
                      alpha = I(.5)),
                 bins = 25)+
  labs(y = "Frequência Relativa (%)",
       x = "Resíduos") +
  theme_classic()

ggarrange(gráfico,resíduos,  ncol = 2, nrow = 1, common.legend = TRUE, legend = "right")
```

#### Espécies

```{r}
gráfico <- ggplot(AR, aes(x = FE, y = E, color = L2))+
  geom_point()+
  scale_colour_manual(values = c("red","blue" , "green")) +
  stat_smooth(method = "lm",
              se = FALSE,
              fullrange = TRUE,
              size = 1)+
  labs( x = "Área (Log10(Km^2))",
        y = "Número de Espécies (Log10)",
        colour = " ")+
  theme_classic()

REW <- lm(WAVEAR~ARWAVE, data = dados)
RES <- lm(SPLEAR~ARSPLE, data = dados)
RE <- lm(WAV2EAR~ARWAV2E, data = dados)

R1 <- resid(REW)
R2 <- resid(RES)
R3 <- resid(RE)

resíduos <- ggplot()+
  geom_histogram(aes (x = R1,
                      y = stat(count) / sum(count)*100, 
                      fill = I("blue"),
                      col = I("black"),
                      alpha = I(.5)),
                 bins = 25)+
  geom_histogram(aes (x = R2,
                      y = stat(count) / sum(count)*100, 
                      fill = I("red"),
                      col = I("black"),
                      alpha = I(.5)),
                 bins = 25)+
  geom_histogram(aes (x = R3,
                      y = stat(count) / sum(count)*100, 
                      fill = I("green"),
                      col = I("black"),
                      alpha = I(.5)),
                 bins = 25)+
  labs(y = "Frequência Relativa (%)",
       x = "Resíduos") +
  theme_classic()

ggarrange(gráfico,resíduos,  ncol = 2, nrow = 1, common.legend = TRUE, legend = "right")
```

### População

#### Registros

```{r}
gráfico <- ggplot(POP, aes(x = FR, y = R, color = L1))+
  geom_point()+
  scale_colour_manual(values = c("red","blue" , "green")) +
  stat_smooth(method = "lm",
              se = FALSE,
              fullrange = TRUE,
              size = 1)+
  labs( x ="População (Log10)",
        y =  "Número de Registros (Log10)",
        colour = " ")+
  theme_classic()

REW <- lm(WAVRP~PWAVR, data = dados)
RES <- lm(SPLRP~PSPLR, data = dados)
RE <- lm(WAV2RP~PWAV2R, data = dados)

R1 <- resid(REW)
R2 <- resid(RES)
R3 <- resid(RE)

resíduos <- ggplot()+
  geom_histogram(aes (x = R1,
                      y = stat(count) / sum(count)*100, 
                      fill = I("blue"),
                      col = I("black"),
                      alpha = I(.5)),
                 bins = 25)+
  geom_histogram(aes (x = R2,
                      y = stat(count) / sum(count)*100, 
                      fill = I("red"),
                      col = I("black"),
                      alpha = I(.5)),
                 bins = 25)+
  geom_histogram(aes (x = R3,
                      y = stat(count) / sum(count)*100, 
                      fill = I("green"),
                      col = I("black"),
                      alpha = I(.5)),
                 bins = 25)+
  labs(y = "Frequência Relativa (%)",
       x = "Resíduos",
       colour = " ") +
  theme_classic()

ggarrange(gráfico,resíduos,  ncol = 2, nrow = 1, common.legend = TRUE, legend = "right")
```

#### Espécies

```{r}
gráfico <- ggplot(POP, aes(x = FE, y = E, color = L2))+
  geom_point()+
  scale_colour_manual(values = c("red","blue" , "green")) +
  stat_smooth(method = "lm",
              se = FALSE,
              fullrange = TRUE,
              size = 1)+
  labs( x = "População (Log10)",
        y = "Número de Espécies (Log10)")+
  theme_classic()

REW <- lm(WAVRE~PWAVE, data = dados)
RES <- lm(SPLEP~PSPLE, data = dados)
RE <- lm(WAV2EP~PWAV2E, data = dados)

R1 <- resid(REW)
R2 <- resid(RES)
R3 <- resid(RE)

resíduos <- ggplot()+
  geom_histogram(aes (x = R1,
                      y = stat(count) / sum(count)*100, 
                      fill = I("blue"),
                      col = I("black"),
                      alpha = I(.5)),
                 bins = 25)+
  geom_histogram(aes (x = R2,
                      y = stat(count) / sum(count)*100, 
                      fill = I("red"),
                      col = I("black"),
                      alpha = I(.5)),
                 bins = 25)+
  geom_histogram(aes (x = R3,
                      y = stat(count) / sum(count)*100, 
                      fill = I("green"),
                      col = I("black"),
                      alpha = I(.5)),
                 bins = 25)+
  labs(y = "Frequência Relativa (%)",
       x = "Resíduos") +
  theme_classic()

ggarrange(gráfico,resíduos,  ncol = 2, nrow = 1, common.legend = TRUE, legend = "right")
```

### Latitude

#### Registros

```{r}
gráfico <- ggplot(LA, aes(x = FR, y = R, color = L1))+
  geom_point()+
  scale_colour_manual(values = c("red","blue", "green")) +
  stat_smooth(method = "lm",
              se = FALSE,
              fullrange = TRUE,
              size = 1)+
  labs( x ="Latitude (º)",
        y =  "Número de Registros (Log10)",
        colour = " ")+
  theme_classic()

REW <- lm(WAVRLA~LAWAVR, data = dados)
RES <- lm(SPLRLA~LASPLR, data = dados)
RE <- lm(WAV2RLA~LAWAV2R, data = dados)

R1 <- resid(REW)
R2 <- resid(RES)
R3 <- resid(RE)

resíduos <- ggplot()+
  geom_histogram(aes (x = R1,
                      y = stat(count) / sum(count)*100, 
                      fill = I("blue"),
                      col = I("black"),
                      alpha = I(.5)),
                 bins = 25)+
  geom_histogram(aes (x = R2,
                      y = stat(count) / sum(count)*100, 
                      fill = I("red"),
                      col = I("black"),
                      alpha = I(.5)),
                 bins = 25)+
  geom_histogram(aes (x = R3,
                      y = stat(count) / sum(count)*100, 
                      fill = I("green"),
                      col = I("black"),
                      alpha = I(.5)),
                 bins = 25)+
  labs(y = "Frequência Relativa (%)",
       x = "Resíduos") +
  theme_classic()

ggarrange(gráfico,resíduos,  ncol = 2, nrow = 1, common.legend = TRUE, legend = "right")
```

#### Espécies

```{r}
gráfico <- ggplot(LA, aes(x = FE, y = E, color = L2))+
  geom_point()+
  scale_colour_manual(values = c("red","blue", "green")) +
  stat_smooth(method = "lm",
              se = FALSE,
              fullrange = TRUE,
              size = 1)+
  labs( x ="Latitude (º)",
        y = "Número de Espécies (Log10)",
        colour = " ")+
  theme_classic()

REW <- lm(WAVELA~LAWAVE, data = dados)
RES <- lm(SPLELA~LASPLE, data = dados)
RE <- lm(WAV2ELA~LAWAV2E, data = dados)

R1 <- resid(REW)
R2 <- resid(RES)
R3 <- resid(RE)

resíduos <- ggplot()+
  geom_histogram(aes (x = R1,
                      y = stat(count) / sum(count)*100, 
                      fill = I("blue"),
                      col = I("black"),
                      alpha = I(.5)),
                 bins = 25)+
  geom_histogram(aes (x = R2,
                      y = stat(count) / sum(count)*100, 
                      fill = I("red"),
                      col = I("black"),
                      alpha = I(.5)),
                 bins = 25)+
  geom_histogram(aes (x = R3,
                      y = stat(count) / sum(count)*100, 
                      fill = I("green"),
                      col = I("black"),
                      alpha = I(.5)),
                 bins = 25)+
  labs(y = "Frequência Relativa (%)",
       x = "Resíduos") +
  theme_classic()

ggarrange(gráfico,resíduos,  ncol = 2, nrow = 1, common.legend = TRUE, legend = "right")
```

### Longitude

#### Registros

```{r}
gráfico <- ggplot(LO, aes(x = FR, y = R, color = L1))+
  geom_point()+
  scale_colour_manual(values = c("red","blue", "green")) +
  stat_smooth(method = "lm",
              se = FALSE,
              fullrange = TRUE,
              size = 1)+
  labs( x ="Longitude (º)",
        y =  "Número de Registros (Log10)",
        colour = " ")+
  theme_classic()

REW <- lm(WAVRLO~LOWAVR, data = dados)
RES <- lm(SPLRLO~LOSPLR, data = dados)
RE <- lm(WAV2RLO~LOWAV2R, data = dados)

R1 <- resid(REW)
R2 <- resid(RES)
R3 <- resid(RE)

resíduos <- ggplot()+
  geom_histogram(aes (x = R1,
                      y = stat(count) / sum(count)*100, 
                      fill = I("blue"),
                      col = I("black"),
                      alpha = I(.5)),
                 bins = 25)+
  geom_histogram(aes (x = R2,
                      y = stat(count) / sum(count)*100, 
                      fill = I("red"),
                      col = I("black"),
                      alpha = I(.5)),
                 bins = 25)+
  geom_histogram(aes (x = R3,
                      y = stat(count) / sum(count)*100, 
                      fill = I("green"),
                      col = I("black"),
                      alpha = I(.5)),
                 bins = 25)+
  labs(y = "Frequência Relativa (%)",
       x = "Resíduos") +
  theme_classic()

ggarrange(gráfico,resíduos,  ncol = 2, nrow = 1, common.legend = TRUE, legend = "right")
```

#### Espécies

```{r}
gráfico <- ggplot(LO, aes(x = FE, y = E, color = L2))+
  geom_point()+
  scale_colour_manual(values = c("red", "blue", "green")) +
  stat_smooth(method = "lm",
              se = FALSE,
              fullrange = TRUE,
              size = 1)+
  labs( x ="Longitude (º)",
        y = "Número de Espécies (Log10)",
        colour = " ")+
  theme_classic()

REW <- lm(WAVELO~LOWAVE, data = dados)
RES <- lm(SPLELO~LOSPLE, data = dados)
RE <- lm(WAV2ELO~LOWAV2E, data = dados)


R1 <- resid(REW)
R2 <- resid(RES)
R3 <- resid(RE)

resíduos <- ggplot()+
  geom_histogram(aes (x = R1,
                      y = stat(count) / sum(count)*100, 
                      fill = I("blue"),
                      col = I("black"),
                      alpha = I(.5)),
                 bins = 25)+
  geom_histogram(aes (x = R2,
                      y = stat(count) / sum(count)*100, 
                      fill = I("red"),
                      col = I("black"),
                      alpha = I(.5)),
                 bins = 25)+
  geom_histogram(aes (x = R3,
                      y = stat(count) / sum(count)*100, 
                      fill = I("green"),
                      col = I("black"),
                      alpha = I(.5)),
                 bins = 25)+
  labs(y = "Frequência Relativa (%)",
       x = "Resíduos") +
  theme_classic()

ggarrange(gráfico,resíduos,  ncol = 2, nrow = 1, common.legend = TRUE, legend = "right")
```

## Representação 1.2.

### Altitude

#### Registros

```{r}
gráfico <- ggplot(AL, aes(x = FR, y = R, colour = L1))+
  geom_point()+
  scale_colour_manual(values = c("red", "blue", "green")) +
  stat_smooth(method = "lm",
              se = FALSE,
              fullrange = TRUE,
              size = 1)+
  labs( x ="Altitude (m)",
        y =  "Número de Registros (Log10)",
        colour = " ")+
  #guides(colour=FALSE)+
  theme_classic()

REW <- lm(WAVRAL~ALWAVR, data = dados)
RES <- lm(SPLRAL~ALSPLR, data = dados)
RE <- lm(WAV2RAL~ALWAV2R, data = dados)

a <- qplot(fitted(REW), resid(REW))+ 
  geom_point(col = "blue")+
  geom_hline(yintercept=0) + 
  labs(y = "Residuals",
       x = " ")+
  theme_classic()

b <- qplot(fitted(RES), resid(RES))+ 
  geom_point(col = "Red")+
  geom_hline(yintercept=0) + 
  labs(y = "Residuals",
       x = " ")+
  theme_classic()

c <- qplot(fitted(RE), resid(RE))+ 
  geom_point(col = "Green")+
  geom_hline(yintercept=0) + 
  labs(y = "Residuals",
       x = " ")+
  theme_classic()

resíduos <- ggarrange(a,b,c, ncol = 1, nrow = 3)


  
ggarrange(gráfico,resíduos,  ncol = 2, nrow = 1, common.legend = TRUE, legend = "right")
```

#### Espécies

```{r}
gráfico <- ggplot(AL, aes(x = FE, y = E, color = L2))+
  geom_point()+
  scale_colour_manual(values = c("red", "blue", "green")) +
  stat_smooth(method = "lm",
              se = FALSE,
              fullrange = TRUE,
              size = 1)+
  labs( x = "Altitude (m)",
        y = "Número de Espécies (Log10)",
        colour = " ")+
  theme_classic()

REW <- lm(WAVEAL~ALWAVE, data = dados)
RES <- lm(SPLEAL~ALSPLE, data = dados)
RE <- lm(WAV2EAL~ALWAV2E, data = dados)


a <- qplot(fitted(REW), resid(REW))+ 
  geom_point(col = "blue")+
  geom_hline(yintercept=0) + 
  labs(y = "Residuals",
       x = " ")+
  theme_classic()

b <- qplot(fitted(RES), resid(RES))+ 
  geom_point(col = "Red")+
  geom_hline(yintercept=0) + 
  labs(y = "Residuals",
       x = " ")+
  theme_classic()

c <- qplot(fitted(RE), resid(RE))+ 
  geom_point(col = "Green")+
  geom_hline(yintercept=0) + 
  labs(y = "Residuals",
       x = " ")+
  theme_classic()

resíduos <- ggarrange(a,b,c, ncol = 1, nrow = 3)


ggarrange(gráfico,resíduos,  ncol = 2, nrow = 1, common.legend = TRUE, legend = "right")
```

### Área

#### Registros

```{r}

gráfico <- ggplot(AR, aes(x = FR, y = R, color = L1))+
  geom_point()+
  scale_colour_manual(values = c("red", "blue", "green")) +
  stat_smooth(method = "lm",
              se = FALSE,
              fullrange = TRUE,
              size = 1)+
  labs( x ="Área (Log10(Km^2))",
        y =  "Número de Registros (Log10)",
        colour = " ")+
  theme_classic()

REW <- lm(WAVRAR~ARWAVR, data = dados)
RES <- lm(SPLRAR~ARSPLR, data = dados)
RE <- lm(WAV2RAR~ARWAV2R, data = dados)

a <- qplot(fitted(REW), resid(REW))+ 
  geom_point(col = "blue")+
  geom_hline(yintercept=0) + 
  labs(y = "Residuals",
       x = " ")+
  theme_classic()

b <- qplot(fitted(RES), resid(RES))+ 
  geom_point(col = "Red")+
  geom_hline(yintercept=0) + 
  labs(y = "Residuals",
       x = " ")+
  theme_classic()

c <- qplot(fitted(RE), resid(RE))+ 
  geom_point(col = "Green")+
  geom_hline(yintercept=0) + 
  labs(y = "Residuals",
       x = " ")+
  theme_classic()

resíduos <- ggarrange(a,b,c, ncol = 1, nrow = 3)

ggarrange(gráfico,resíduos,  ncol = 2, nrow = 1, common.legend = TRUE, legend = "right")
```

#### Espécies

```{r}
gráfico <- ggplot(AR, aes(x = FE, y = E, color = L2))+
  geom_point()+
  scale_colour_manual(values = c("red","blue" , "green")) +
  stat_smooth(method = "lm",
              se = FALSE,
              fullrange = TRUE,
              size = 1)+
  labs( x = "Área (Log10(Km^2))",
        y = "Número de Espécies (Log10)",
        colour = " ")+
  theme_classic()

REW <- lm(WAVEAR~ARWAVE, data = dados)
RES <- lm(SPLEAR~ARSPLE, data = dados)
RE <- lm(WAV2EAR~ARWAV2E, data = dados)

a <- qplot(fitted(REW), resid(REW))+ 
  geom_point(col = "blue")+
  geom_hline(yintercept=0) + 
  labs(y = "Residuals",
       x = " ")+
  theme_classic()

b <- qplot(fitted(RES), resid(RES))+ 
  geom_point(col = "Red")+
  geom_hline(yintercept=0) + 
  labs(y = "Residuals",
       x = " ")+
  theme_classic()

c <- qplot(fitted(RE), resid(RE))+ 
  geom_point(col = "Green")+
  geom_hline(yintercept=0) + 
  labs(y = "Residuals",
       x = " ")+
  theme_classic()

resíduos <- ggarrange(a,b,c, ncol = 1, nrow = 3)

ggarrange(gráfico,resíduos,  ncol = 2, nrow = 1, common.legend = TRUE, legend = "right")
```

### População

#### Registros

```{r}
gráfico <- ggplot(POP, aes(x = FR, y = R, color = L1))+
  geom_point()+
  scale_colour_manual(values = c("red","blue" , "green")) +
  stat_smooth(method = "lm",
              se = FALSE,
              fullrange = TRUE,
              size = 1)+
  labs( x ="População (Log10)",
        y =  "Número de Registros (Log10)",
        colour = " ")+
  theme_classic()

REW <- lm(WAVRP~PWAVR, data = dados)
RES <- lm(SPLRP~PSPLR, data = dados)
RE <- lm(WAV2RP~PWAV2R, data = dados)

a <- qplot(fitted(REW), resid(REW))+ 
  geom_point(col = "blue")+
  geom_hline(yintercept=0) + 
  labs(y = "Residuals",
       x = " ")+
  theme_classic()

b <- qplot(fitted(RES), resid(RES))+ 
  geom_point(col = "Red")+
  geom_hline(yintercept=0) + 
  labs(y = "Residuals",
       x = " ")+
  theme_classic()

c <- qplot(fitted(RE), resid(RE))+ 
  geom_point(col = "Green")+
  geom_hline(yintercept=0) + 
  labs(y = "Residuals",
       x = " ")+
  theme_classic()

resíduos <- ggarrange(a,b,c, ncol = 1, nrow = 3)

ggarrange(gráfico,resíduos,  ncol = 2, nrow = 1, common.legend = TRUE, legend = "right")
```

#### Espécies

```{r}
gráfico <- ggplot(POP, aes(x = FE, y = E, color = L2))+
  geom_point()+
  scale_colour_manual(values = c("red","blue" , "green")) +
  stat_smooth(method = "lm",
              se = FALSE,
              fullrange = TRUE,
              size = 1)+
  labs( x = "População (Log10)",
        y = "Número de Espécies (Log10)")+
  theme_classic()

REW <- lm(WAVRE~PWAVE, data = dados)
RES <- lm(SPLEP~PSPLE, data = dados)
RE <- lm(WAV2EP~PWAV2E, data = dados)

a <- qplot(fitted(REW), resid(REW))+ 
  geom_point(col = "blue")+
  geom_hline(yintercept=0) + 
  labs(y = "Residuals",
       x = " ")+
  theme_classic()

b <- qplot(fitted(RES), resid(RES))+ 
  geom_point(col = "Red")+
  geom_hline(yintercept=0) + 
  labs(y = "Residuals",
       x = " ")+
  theme_classic()

c <- qplot(fitted(RE), resid(RE))+ 
  geom_point(col = "Green")+
  geom_hline(yintercept=0) + 
  labs(y = "Residuals",
       x = " ")+
  theme_classic()

resíduos <- ggarrange(a,b,c, ncol = 1, nrow = 3)

ggarrange(gráfico,resíduos,  ncol = 2, nrow = 1, common.legend = TRUE, legend = "right")
```

### Latitude

#### Registros

```{r}
gráfico <- ggplot(LA, aes(x = FR, y = R, color = L1))+
  geom_point()+
  scale_colour_manual(values = c("red","blue", "green")) +
  stat_smooth(method = "lm",
              se = FALSE,
              fullrange = TRUE,
              size = 1)+
  labs( x ="Latitude (º)",
        y =  "Número de Registros (Log10)",
        colour = " ")+
  theme_classic()

REW <- lm(WAVRLA~LAWAVR, data = dados)
RES <- lm(SPLRLA~LASPLR, data = dados)
RE <- lm(WAV2RLA~LAWAV2R, data = dados)

a <- qplot(fitted(REW), resid(REW))+ 
  geom_point(col = "blue")+
  geom_hline(yintercept=0) + 
  labs(y = "Residuals",
       x = " ")+
  theme_classic()

b <- qplot(fitted(RES), resid(RES))+ 
  geom_point(col = "Red")+
  geom_hline(yintercept=0) + 
  labs(y = "Residuals",
       x = " ")+
  theme_classic()

c <- qplot(fitted(RE), resid(RE))+ 
  geom_point(col = "Green")+
  geom_hline(yintercept=0) + 
  labs(y = "Residuals",
       x = " ")+
  theme_classic()

resíduos <- ggarrange(a,b,c, ncol = 1, nrow = 3)

ggarrange(gráfico,resíduos,  ncol = 2, nrow = 1, common.legend = TRUE, legend = "right")
```

#### Espécies

```{r}
gráfico <- ggplot(LA, aes(x = FE, y = E, color = L2))+
  geom_point()+
  scale_colour_manual(values = c("red","blue", "green")) +
  stat_smooth(method = "lm",
              se = FALSE,
              fullrange = TRUE,
              size = 1)+
  labs( x ="Latitude (º)",
        y = "Número de Espécies (Log10)",
        colour = " ")+
  theme_classic()

REW <- lm(WAVELA~LAWAVE, data = dados)
RES <- lm(SPLELA~LASPLE, data = dados)
RE <- lm(WAV2ELA~LAWAV2E, data = dados)

a <- qplot(fitted(REW), resid(REW))+ 
  geom_point(col = "blue")+
  geom_hline(yintercept=0) + 
  labs(y = "Residuals",
       x = " ")+
  theme_classic()

b <- qplot(fitted(RES), resid(RES))+ 
  geom_point(col = "Red")+
  geom_hline(yintercept=0) + 
  labs(y = "Residuals",
       x = " ")+
  theme_classic()

c <- qplot(fitted(RE), resid(RE))+ 
  geom_point(col = "Green")+
  geom_hline(yintercept=0) + 
  labs(y = "Residuals",
       x = " ")+
  theme_classic()

resíduos <- ggarrange(a,b,c, ncol = 1, nrow = 3)

ggarrange(gráfico,resíduos,  ncol = 2, nrow = 1, common.legend = TRUE, legend = "right")
```

### Longitude

#### Registros

```{r}
gráfico <- ggplot(LO, aes(x = FR, y = R, color = L1))+
  geom_point()+
  scale_colour_manual(values = c("red","blue", "green")) +
  stat_smooth(method = "lm",
              se = FALSE,
              fullrange = TRUE,
              size = 1)+
  labs( x ="Longitude (º)",
        y =  "Número de Registros (Log10)",
        colour = " ")+
  theme_classic()

REW <- lm(WAVRLO~LOWAVR, data = dados)
RES <- lm(SPLRLO~LOSPLR, data = dados)
RE <- lm(WAV2RLO~LOWAV2R, data = dados)

a <- qplot(fitted(REW), resid(REW))+ 
  geom_point(col = "blue")+
  geom_hline(yintercept=0) + 
  labs(y = "Residuals",
       x = " ")+
  theme_classic()

b <- qplot(fitted(RES), resid(RES))+ 
  geom_point(col = "Red")+
  geom_hline(yintercept=0) + 
  labs(y = "Residuals",
       x = " ")+
  theme_classic()

c <- qplot(fitted(RE), resid(RE))+ 
  geom_point(col = "Green")+
  geom_hline(yintercept=0) + 
  labs(y = "Residuals",
       x = " ")+
  theme_classic()

resíduos <- ggarrange(a,b,c, ncol = 1, nrow = 3)

ggarrange(gráfico,resíduos,  ncol = 2, nrow = 1, common.legend = TRUE, legend = "right")
```

#### Espécies

```{r}
gráfico <- ggplot(LO, aes(x = FE, y = E, color = L2))+
  geom_point()+
  scale_colour_manual(values = c("red", "blue", "green")) +
  stat_smooth(method = "lm",
              se = FALSE,
              fullrange = TRUE,
              size = 1)+
  labs( x ="Longitude (º)",
        y = "Número de Espécies (Log10)",
        colour = " ")+
  theme_classic()

REW <- lm(WAVELO~LOWAVE, data = dados)
RES <- lm(SPLELO~LOSPLE, data = dados)
RE <- lm(WAV2ELO~LOWAV2E, data = dados)

a <- qplot(fitted(REW), resid(REW))+ 
  geom_point(col = "blue")+
  geom_hline(yintercept=0) + 
  labs(y = "Residuals",
       x = " ")+
  theme_classic()

b <- qplot(fitted(RES), resid(RES))+ 
  geom_point(col = "Red")+
  geom_hline(yintercept=0) + 
  labs(y = "Residuals",
       x = " ")+
  theme_classic()

c <- qplot(fitted(RE), resid(RE))+ 
  geom_point(col = "Green")+
  geom_hline(yintercept=0) + 
  labs(y = "Residuals",
       x = " ")+
  theme_classic()

resíduos <- ggarrange(a,b,c, ncol = 1, nrow = 3)

ggarrange(gráfico,resíduos,  ncol = 2, nrow = 1, common.legend = TRUE, legend = "right")
```

## Representação 2.1.

### Altitude

#### Registros

```{r}
gráfico <- ggplot(AL, aes(x = FR, y = R, colour = L1, alpha =I(.5)))+
  geom_point()+
  scale_colour_manual(values = c("red", "blue", "green")) +
  stat_smooth(method = "lm",
              se = FALSE,
              fullrange = TRUE,
              size = 1)+
  labs( x ="Altitude (m)",
        y =  "Número de Registros (Log10)",
        colour = " ")+
  #guides(colour=FALSE)+
  theme_classic()

REW <- lm(WAVRAL~ALWAVR, data = dados)
RES <- lm(SPLRAL~ALSPLR, data = dados)
RE <- lm(WAV2RAL~ALWAV2R, data = dados)

R1 <- resid(REW)
R2 <- resid(RES)
R3 <- resid(RE)


resíduos <- ggplot()+
  geom_histogram(aes (x = R1,
                      y = stat(count) / sum(count)*100, 
                      fill = I("blue"),
                      col = I("black"),
                      alpha = I(.5)),
                 bins = 25)+
  geom_histogram(aes (x = R2,
                      y = stat(count) / sum(count)*100, 
                      fill = I("red"),
                      col = I("black"),
                      alpha = I(.5)),
                 bins = 25)+
  geom_histogram(aes (x = R3,
                      y = stat(count) / sum(count)*100, 
                      fill = I("green"),
                      col = I("black"),
                      alpha = I(.5)),
                 bins = 25)+
  labs(y = "Frequência Relativa (%)",
       x = "Resíduos") +
  theme_classic()

ggarrange(gráfico,resíduos,  ncol = 2, nrow = 1, common.legend = TRUE, legend = "right")
```

#### Espécies

```{r}
gráfico <- ggplot(AL, aes(x = FE, y = E, color = L2, alpha =I(.5)))+
  geom_point()+
  scale_colour_manual(values = c("red", "blue", "green")) +
  stat_smooth(method = "lm",
              se = FALSE,
              fullrange = TRUE,
              size = 1)+
  labs( x = "Altitude (m)",
        y = "Número de Espécies (Log10)",
        colour = " ")+
  theme_classic()

REW <- lm(WAVEAL~ALWAVE, data = dados)
RES <- lm(SPLEAL~ALSPLE, data = dados)
RE <- lm(WAV2EAL~ALWAV2E, data = dados)

R1 <- resid(REW)
R2 <- resid(RES)
R3 <- resid(RE)

resíduos <- ggplot()+
  geom_histogram(aes (x = R1,
                      y = stat(count) / sum(count)*100, 
                      fill = I("blue"),
                      col = I("black"),
                      alpha = I(.5)),
                 bins = 25)+
  geom_histogram(aes (x = R2,
                      y = stat(count) / sum(count)*100, 
                      fill = I("red"),
                      col = I("black"),
                      alpha = I(.5)),
                 bins = 25)+
  geom_histogram(aes (x = R3,
                      y = stat(count) / sum(count)*100, 
                      fill = I("green"),
                      col = I("black"),
                      alpha = I(.5)),
                 bins = 25)+
  labs(y = "Frequência Relativa (%)",
       x = "Resíduos") +
  theme_classic()

ggarrange(gráfico,resíduos,  ncol = 2, nrow = 1, common.legend = TRUE, legend = "right")
```

### Área

#### Registros

```{r}
gráfico <- ggplot(AR, aes(x = FR, y = R, color = L1, alpha =I(.5)))+
  geom_point()+
  scale_colour_manual(values = c("red", "blue", "green")) +
  stat_smooth(method = "lm",
              se = FALSE,
              fullrange = TRUE,
              size = 1)+
  labs( x ="Área (Log10(Km^2))",
        y =  "Número de Registros (Log10)",
        colour = " ")+
  theme_classic()

REW <- lm(WAVRAR~ARWAVR, data = dados)
RES <- lm(SPLRAR~ARSPLR, data = dados)
RE <- lm(WAV2RAR~ARWAV2R, data = dados)

R1 <- resid(REW)
R2 <- resid(RES)
R3 <- resid(RE)

resíduos <- ggplot()+
  geom_histogram(aes (x = R1,
                      y = stat(count) / sum(count)*100, 
                      fill = I("blue"),
                      col = I("black"),
                      alpha = I(.5)),
                 bins = 25)+
  geom_histogram(aes (x = R2,
                      y = stat(count) / sum(count)*100, 
                      fill = I("red"),
                      col = I("black"),
                      alpha = I(.5)),
                 bins = 25)+
  geom_histogram(aes (x = R3,
                      y = stat(count) / sum(count)*100, 
                      fill = I("green"),
                      col = I("black"),
                      alpha = I(.5)),
                 bins = 25)+
  labs(y = "Frequência Relativa (%)",
       x = "Resíduos") +
  theme_classic()

ggarrange(gráfico,resíduos,  ncol = 2, nrow = 1, common.legend = TRUE, legend = "right")
```

#### Espécies

```{r}
gráfico <- ggplot(AR, aes(x = FE, y = E, color = L2, alpha =I(.5)))+
  geom_point()+
  scale_colour_manual(values = c("red","blue" , "green")) +
  stat_smooth(method = "lm",
              se = FALSE,
              fullrange = TRUE,
              size = 1)+
  labs( x = "Área (Log10(Km^2))",
        y = "Número de Espécies (Log10)",
        colour = " ")+
  theme_classic()

REW <- lm(WAVEAR~ARWAVE, data = dados)
RES <- lm(SPLEAR~ARSPLE, data = dados)
RE <- lm(WAV2EAR~ARWAV2E, data = dados)

R1 <- resid(REW)
R2 <- resid(RES)
R3 <- resid(RE)

resíduos <- ggplot()+
  geom_histogram(aes (x = R1,
                      y = stat(count) / sum(count)*100, 
                      fill = I("blue"),
                      col = I("black"),
                      alpha = I(.5)),
                 bins = 25)+
  geom_histogram(aes (x = R2,
                      y = stat(count) / sum(count)*100, 
                      fill = I("red"),
                      col = I("black"),
                      alpha = I(.5)),
                 bins = 25)+
  geom_histogram(aes (x = R3,
                      y = stat(count) / sum(count)*100, 
                      fill = I("green"),
                      col = I("black"),
                      alpha = I(.5)),
                 bins = 25)+
  labs(y = "Frequência Relativa (%)",
       x = "Resíduos") +
  theme_classic()

ggarrange(gráfico,resíduos,  ncol = 2, nrow = 1, common.legend = TRUE, legend = "right")
```

### População

#### Registros

```{r}
gráfico <- ggplot(POP, aes(x = FR, y = R, color = L1, alpha =I(.5)))+
  geom_point()+
  scale_colour_manual(values = c("red","blue" , "green")) +
  stat_smooth(method = "lm",
              se = FALSE,
              fullrange = TRUE,
              size = 1)+
  labs( x ="População (Log10)",
        y =  "Número de Registros (Log10)",
        colour = " ")+
  theme_classic()

REW <- lm(WAVRP~PWAVR, data = dados)
RES <- lm(SPLRP~PSPLR, data = dados)
RE <- lm(WAV2RP~PWAV2R, data = dados)

R1 <- resid(REW)
R2 <- resid(RES)
R3 <- resid(RE)

resíduos <- ggplot()+
  geom_histogram(aes (x = R1,
                      y = stat(count) / sum(count)*100, 
                      fill = I("blue"),
                      col = I("black"),
                      alpha = I(.5)),
                 bins = 25)+
  geom_histogram(aes (x = R2,
                      y = stat(count) / sum(count)*100, 
                      fill = I("red"),
                      col = I("black"),
                      alpha = I(.5)),
                 bins = 25)+
  geom_histogram(aes (x = R3,
                      y = stat(count) / sum(count)*100, 
                      fill = I("green"),
                      col = I("black"),
                      alpha = I(.5)),
                 bins = 25)+
  labs(y = "Frequência Relativa (%)",
       x = "Resíduos",
       colour = " ") +
  theme_classic()

ggarrange(gráfico,resíduos,  ncol = 2, nrow = 1, common.legend = TRUE, legend = "right")
```

#### Espécies

```{r}
gráfico <- ggplot(POP, aes(x = FE, y = E, color = L2, alpha =I(.5)))+
  geom_point()+
  scale_colour_manual(values = c("red","blue" , "green")) +
  stat_smooth(method = "lm",
              se = FALSE,
              fullrange = TRUE,
              size = 1)+
  labs( x = "População (Log10)",
        y = "Número de Espécies (Log10)")+
  theme_classic()

REW <- lm(WAVRE~PWAVE, data = dados)
RES <- lm(SPLEP~PSPLE, data = dados)
RE <- lm(WAV2EP~PWAV2E, data = dados)

R1 <- resid(REW)
R2 <- resid(RES)
R3 <- resid(RE)

resíduos <- ggplot()+
  geom_histogram(aes (x = R1,
                      y = stat(count) / sum(count)*100, 
                      fill = I("blue"),
                      col = I("black"),
                      alpha = I(.5)),
                 bins = 25)+
  geom_histogram(aes (x = R2,
                      y = stat(count) / sum(count)*100, 
                      fill = I("red"),
                      col = I("black"),
                      alpha = I(.5)),
                 bins = 25)+
  geom_histogram(aes (x = R3,
                      y = stat(count) / sum(count)*100, 
                      fill = I("green"),
                      col = I("black"),
                      alpha = I(.5)),
                 bins = 25)+
  labs(y = "Frequência Relativa (%)",
       x = "Resíduos") +
  theme_classic()

ggarrange(gráfico,resíduos,  ncol = 2, nrow = 1, common.legend = TRUE, legend = "right")
```

### Latitude

#### Registros

```{r}
gráfico <- ggplot(LA, aes(x = FR, y = R, color = L1, alpha =I(.5)))+
  geom_point()+
  scale_colour_manual(values = c("red","blue", "green")) +
  stat_smooth(method = "lm",
              se = FALSE,
              fullrange = TRUE,
              size = 1)+
  labs( x ="Latitude (º)",
        y =  "Número de Registros (Log10)",
        colour = " ")+
  theme_classic()

REW <- lm(WAVRLA~LAWAVR, data = dados)
RES <- lm(SPLRLA~LASPLR, data = dados)
RE <- lm(WAV2RLA~LAWAV2R, data = dados)

R1 <- resid(REW)
R2 <- resid(RES)
R3 <- resid(RE)

resíduos <- ggplot()+
  geom_histogram(aes (x = R1,
                      y = stat(count) / sum(count)*100, 
                      fill = I("blue"),
                      col = I("black"),
                      alpha = I(.5)),
                 bins = 25)+
  geom_histogram(aes (x = R2,
                      y = stat(count) / sum(count)*100, 
                      fill = I("red"),
                      col = I("black"),
                      alpha = I(.5)),
                 bins = 25)+
  geom_histogram(aes (x = R3,
                      y = stat(count) / sum(count)*100, 
                      fill = I("green"),
                      col = I("black"),
                      alpha = I(.5)),
                 bins = 25)+
  labs(y = "Frequência Relativa (%)",
       x = "Resíduos") +
  theme_classic()

ggarrange(gráfico,resíduos,  ncol = 2, nrow = 1, common.legend = TRUE, legend = "right")
```

#### Espécies

```{r}
gráfico <- ggplot(LA, aes(x = FE, y = E, color = L2, alpha =I(.5)))+
  geom_point()+
  scale_colour_manual(values = c("red","blue", "green")) +
  stat_smooth(method = "lm",
              se = FALSE,
              fullrange = TRUE,
              size = 1)+
  labs( x ="Latitude (º)",
        y = "Número de Espécies (Log10)",
        colour = " ")+
  theme_classic()

REW <- lm(WAVELA~LAWAVE, data = dados)
RES <- lm(SPLELA~LASPLE, data = dados)
RE <- lm(WAV2ELA~LAWAV2E, data = dados)

R1 <- resid(REW)
R2 <- resid(RES)
R3 <- resid(RE)

resíduos <- ggplot()+
  geom_histogram(aes (x = R1,
                      y = stat(count) / sum(count)*100, 
                      fill = I("blue"),
                      col = I("black"),
                      alpha = I(.5)),
                 bins = 25)+
  geom_histogram(aes (x = R2,
                      y = stat(count) / sum(count)*100, 
                      fill = I("red"),
                      col = I("black"),
                      alpha = I(.5)),
                 bins = 25)+
  geom_histogram(aes (x = R3,
                      y = stat(count) / sum(count)*100, 
                      fill = I("green"),
                      col = I("black"),
                      alpha = I(.5)),
                 bins = 25)+
  labs(y = "Frequência Relativa (%)",
       x = "Resíduos") +
  theme_classic()

ggarrange(gráfico,resíduos,  ncol = 2, nrow = 1, common.legend = TRUE, legend = "right")
```

### Longitude

#### Registros

```{r}
gráfico <- ggplot(LO, aes(x = FR, y = R, color = L1, alpha =I(.5)))+
  geom_point()+
  scale_colour_manual(values = c("red","blue", "green")) +
  stat_smooth(method = "lm",
              se = FALSE,
              fullrange = TRUE,
              size = 1)+
  labs( x ="Longitude (º)",
        y =  "Número de Registros (Log10)",
        colour = " ")+
  theme_classic()

REW <- lm(WAVRLO~LOWAVR, data = dados)
RES <- lm(SPLRLO~LOSPLR, data = dados)
RE <- lm(WAV2RLO~LOWAV2R, data = dados)

R1 <- resid(REW)
R2 <- resid(RES)
R3 <- resid(RE)

resíduos <- ggplot()+
  geom_histogram(aes (x = R1,
                      y = stat(count) / sum(count)*100, 
                      fill = I("blue"),
                      col = I("black"),
                      alpha = I(.5)),
                 bins = 25)+
  geom_histogram(aes (x = R2,
                      y = stat(count) / sum(count)*100, 
                      fill = I("red"),
                      col = I("black"),
                      alpha = I(.5)),
                 bins = 25)+
  geom_histogram(aes (x = R3,
                      y = stat(count) / sum(count)*100, 
                      fill = I("green"),
                      col = I("black"),
                      alpha = I(.5)),
                 bins = 25)+
  labs(y = "Frequência Relativa (%)",
       x = "Resíduos") +
  theme_classic()

ggarrange(gráfico,resíduos,  ncol = 2, nrow = 1, common.legend = TRUE, legend = "right")
```

#### Espécies

```{r}
gráfico <- ggplot(LO, aes(x = FE, y = E, color = L2, alpha =I(.5)))+
  geom_point()+
  scale_colour_manual(values = c("red", "blue", "green")) +
  stat_smooth(method = "lm",
              se = FALSE,
              fullrange = TRUE,
              size = 1)+
  labs( x ="Longitude (º)",
        y = "Número de Espécies (Log10)",
        colour = " ")+
  theme_classic()

REW <- lm(WAVELO~LOWAVE, data = dados)
RES <- lm(SPLELO~LOSPLE, data = dados)
RE <- lm(WAV2ELO~LOWAV2E, data = dados)

R1 <- resid(REW)
R2 <- resid(RES)
R3 <- resid(RE)

resíduos <- ggplot()+
  geom_histogram(aes (x = R1,
                      y = stat(count) / sum(count)*100, 
                      fill = I("blue"),
                      col = I("black"),
                      alpha = I(.5)),
                 bins = 25)+
  geom_histogram(aes (x = R2,
                      y = stat(count) / sum(count)*100, 
                      fill = I("red"),
                      col = I("black"),
                      alpha = I(.5)),
                 bins = 25)+
  geom_histogram(aes (x = R3,
                      y = stat(count) / sum(count)*100, 
                      fill = I("green"),
                      col = I("black"),
                      alpha = I(.5)),
                 bins = 25)+
  labs(y = "Frequência Relativa (%)",
       x = "Resíduos") +
  theme_classic()

ggarrange(gráfico,resíduos,  ncol = 2, nrow = 1, common.legend = TRUE, legend = "right")
```

## Representação 2.2.

### Altitude

#### Registros

```{r}
gráfico <- ggplot(AL, aes(x = FR, y = R, colour = L1, alpha =I(.5)))+
  geom_point()+
  scale_colour_manual(values = c("red", "blue", "green")) +
  stat_smooth(method = "lm",
              se = FALSE,
              fullrange = TRUE,
              size = 1)+
  labs( x ="Altitude (m)",
        y =  "Número de Registros (Log10)",
        colour = " ")+
  theme_classic()

REW <- lm(WAVRAL~ALWAVR, data = dados)
RES <- lm(SPLRAL~ALSPLR, data = dados)
RE <- lm(WAV2RAL~ALWAV2R, data = dados)

a <- qplot(fitted(REW), resid(REW))+ 
  geom_point(col = "blue")+
  geom_hline(yintercept=0) + 
  labs(y = "Residuals",
       x = " ")+
  theme_classic()

b <- qplot(fitted(RES), resid(RES))+ 
  geom_point(col = "Red")+
  geom_hline(yintercept=0) + 
  labs(y = "Residuals",
       x = " ")+
  theme_classic()

c <- qplot(fitted(RE), resid(RE))+ 
  geom_point(col = "Green")+
  geom_hline(yintercept=0) + 
  labs(y = "Residuals",
       x = " ")+
  theme_classic()

resíduos <- ggarrange(a,b,c, ncol = 1, nrow = 3)


  
ggarrange(gráfico,resíduos,  ncol = 2, nrow = 1, common.legend = TRUE, legend = "right")
```

#### Espécies

```{r}
gráfico <- ggplot(AL, aes(x = FE, y = E, color = L2, alpha =I(.5)))+
  geom_point()+
  scale_colour_manual(values = c("red", "blue", "green")) +
  stat_smooth(method = "lm",
              se = FALSE,
              fullrange = TRUE,
              size = 1)+
  labs( x = "Altitude (m)",
        y = "Número de Espécies (Log10)",
        colour = " ")+
  theme_classic()

REW <- lm(WAVEAL~ALWAVE, data = dados)
RES <- lm(SPLEAL~ALSPLE, data = dados)
RE <- lm(WAV2EAL~ALWAV2E, data = dados)


a <- qplot(fitted(REW), resid(REW))+ 
  geom_point(col = "blue")+
  geom_hline(yintercept=0) + 
  labs(y = "Residuals",
       x = " ")+
  theme_classic()

b <- qplot(fitted(RES), resid(RES))+ 
  geom_point(col = "Red")+
  geom_hline(yintercept=0) + 
  labs(y = "Residuals",
       x = " ")+
  theme_classic()

c <- qplot(fitted(RE), resid(RE))+ 
  geom_point(col = "Green")+
  geom_hline(yintercept=0) + 
  labs(y = "Residuals",
       x = " ")+
  theme_classic()

resíduos <- ggarrange(a,b,c, ncol = 1, nrow = 3)


ggarrange(gráfico,resíduos,  ncol = 2, nrow = 1, common.legend = TRUE, legend = "right")
```

### Área

#### Registros

```{r}

gráfico <- ggplot(AR, aes(x = FR, y = R, color = L1, alpha =I(.5)))+
  geom_point()+
  scale_colour_manual(values = c("red", "blue", "green")) +
  stat_smooth(method = "lm",
              se = FALSE,
              fullrange = TRUE,
              size = 1)+
  labs( x ="Área (Log10(Km^2))",
        y =  "Número de Registros (Log10)",
        colour = " ")+
  theme_classic()

REW <- lm(WAVRAR~ARWAVR, data = dados)
RES <- lm(SPLRAR~ARSPLR, data = dados)
RE <- lm(WAV2RAR~ARWAV2R, data = dados)

a <- qplot(fitted(REW), resid(REW))+ 
  geom_point(col = "blue")+
  geom_hline(yintercept=0) + 
  labs(y = "Residuals",
       x = " ")+
  theme_classic()

b <- qplot(fitted(RES), resid(RES))+ 
  geom_point(col = "Red")+
  geom_hline(yintercept=0) + 
  labs(y = "Residuals",
       x = " ")+
  theme_classic()

c <- qplot(fitted(RE), resid(RE))+ 
  geom_point(col = "Green")+
  geom_hline(yintercept=0) + 
  labs(y = "Residuals",
       x = " ")+
  theme_classic()

resíduos <- ggarrange(a,b,c, ncol = 1, nrow = 3)

ggarrange(gráfico,resíduos,  ncol = 2, nrow = 1, common.legend = TRUE, legend = "right")
```

#### Espécies

```{r}
gráfico <- ggplot(AR, aes(x = FE, y = E, color = L2, alpha =I(.5)))+
  geom_point()+
  scale_colour_manual(values = c("red","blue" , "green")) +
  stat_smooth(method = "lm",
              se = FALSE,
              fullrange = TRUE,
              size = 1)+
  labs( x = "Área (Log10(Km^2))",
        y = "Número de Espécies (Log10)",
        colour = " ")+
  theme_classic()

REW <- lm(WAVEAR~ARWAVE, data = dados)
RES <- lm(SPLEAR~ARSPLE, data = dados)
RE <- lm(WAV2EAR~ARWAV2E, data = dados)

a <- qplot(fitted(REW), resid(REW))+ 
  geom_point(col = "blue")+
  geom_hline(yintercept=0) + 
  labs(y = "Residuals",
       x = " ")+
  theme_classic()

b <- qplot(fitted(RES), resid(RES))+ 
  geom_point(col = "Red")+
  geom_hline(yintercept=0) + 
  labs(y = "Residuals",
       x = " ")+
  theme_classic()

c <- qplot(fitted(RE), resid(RE))+ 
  geom_point(col = "Green")+
  geom_hline(yintercept=0) + 
  labs(y = "Residuals",
       x = " ")+
  theme_classic()

resíduos <- ggarrange(a,b,c, ncol = 1, nrow = 3)

ggarrange(gráfico,resíduos,  ncol = 2, nrow = 1, common.legend = TRUE, legend = "right")
```

### População

#### Registros

```{r}
gráfico <- ggplot(POP, aes(x = FR, y = R, color = L1, alpha =I(.5)))+
  geom_point()+
  scale_colour_manual(values = c("red","blue" , "green")) +
  stat_smooth(method = "lm",
              se = FALSE,
              fullrange = TRUE,
              size = 1)+
  labs( x ="População (Log10)",
        y =  "Número de Registros (Log10)",
        colour = " ")+
  theme_classic()

REW <- lm(WAVRP~PWAVR, data = dados)
RES <- lm(SPLRP~PSPLR, data = dados)
RE <- lm(WAV2RP~PWAV2R, data = dados)

a <- qplot(fitted(REW), resid(REW))+ 
  geom_point(col = "blue")+
  geom_hline(yintercept=0) + 
  labs(y = "Residuals",
       x = " ")+
  theme_classic()

b <- qplot(fitted(RES), resid(RES))+ 
  geom_point(col = "Red")+
  geom_hline(yintercept=0) + 
  labs(y = "Residuals",
       x = " ")+
  theme_classic()

c <- qplot(fitted(RE), resid(RE))+ 
  geom_point(col = "Green")+
  geom_hline(yintercept=0) + 
  labs(y = "Residuals",
       x = " ")+
  theme_classic()

resíduos <- ggarrange(a,b,c, ncol = 1, nrow = 3)

ggarrange(gráfico,resíduos,  ncol = 2, nrow = 1, common.legend = TRUE, legend = "right")
```

#### Espécies

```{r}
gráfico <- ggplot(POP, aes(x = FE, y = E, color = L2, alpha =I(.5)))+
  geom_point()+
  scale_colour_manual(values = c("red","blue" , "green")) +
  stat_smooth(method = "lm",
              se = FALSE,
              fullrange = TRUE,
              size = 1)+
  labs( x = "População (Log10)",
        y = "Número de Espécies (Log10)")+
  theme_classic()

REW <- lm(WAVRE~PWAVE, data = dados)
RES <- lm(SPLEP~PSPLE, data = dados)
RE <- lm(WAV2EP~PWAV2E, data = dados)

a <- qplot(fitted(REW), resid(REW))+ 
  geom_point(col = "blue")+
  geom_hline(yintercept=0) + 
  labs(y = "Residuals",
       x = " ")+
  theme_classic()

b <- qplot(fitted(RES), resid(RES))+ 
  geom_point(col = "Red")+
  geom_hline(yintercept=0) + 
  labs(y = "Residuals",
       x = " ")+
  theme_classic()

c <- qplot(fitted(RE), resid(RE))+ 
  geom_point(col = "Green")+
  geom_hline(yintercept=0) + 
  labs(y = "Residuals",
       x = " ")+
  theme_classic()

resíduos <- ggarrange(a,b,c, ncol = 1, nrow = 3)

ggarrange(gráfico,resíduos,  ncol = 2, nrow = 1, common.legend = TRUE, legend = "right")
```

### Latitude

#### Registros

```{r}
gráfico <- ggplot(LA, aes(x = FR, y = R, color = L1, alpha =I(.5)))+
  geom_point()+
  scale_colour_manual(values = c("red","blue", "green")) +
  stat_smooth(method = "lm",
              se = FALSE,
              fullrange = TRUE,
              size = 1)+
  labs( x ="Latitude (º)",
        y =  "Número de Registros (Log10)",
        colour = " ")+
  theme_classic()

REW <- lm(WAVRLA~LAWAVR, data = dados)
RES <- lm(SPLRLA~LASPLR, data = dados)
RE <- lm(WAV2RLA~LAWAV2R, data = dados)

a <- qplot(fitted(REW), resid(REW))+ 
  geom_point(col = "blue")+
  geom_hline(yintercept=0) + 
  labs(y = "Residuals",
       x = " ")+
  theme_classic()

b <- qplot(fitted(RES), resid(RES))+ 
  geom_point(col = "Red")+
  geom_hline(yintercept=0) + 
  labs(y = "Residuals",
       x = " ")+
  theme_classic()

c <- qplot(fitted(RE), resid(RE))+ 
  geom_point(col = "Green")+
  geom_hline(yintercept=0) + 
  labs(y = "Residuals",
       x = " ")+
  theme_classic()

resíduos <- ggarrange(a,b,c, ncol = 1, nrow = 3)

ggarrange(gráfico,resíduos,  ncol = 2, nrow = 1, common.legend = TRUE, legend = "right")
```

#### Espécies

```{r}
gráfico <- ggplot(LA, aes(x = FE, y = E, color = L2, alpha =I(.5)))+
  geom_point()+
  scale_colour_manual(values = c("red","blue", "green")) +
  stat_smooth(method = "lm",
              se = FALSE,
              fullrange = TRUE,
              size = 1)+
  labs( x ="Latitude (º)",
        y = "Número de Espécies (Log10)",
        colour = " ")+
  theme_classic()

REW <- lm(WAVELA~LAWAVE, data = dados)
RES <- lm(SPLELA~LASPLE, data = dados)
RE <- lm(WAV2ELA~LAWAV2E, data = dados)

a <- qplot(fitted(REW), resid(REW))+ 
  geom_point(col = "blue")+
  geom_hline(yintercept=0) + 
  labs(y = "Residuals",
       x = " ")+
  theme_classic()

b <- qplot(fitted(RES), resid(RES))+ 
  geom_point(col = "Red")+
  geom_hline(yintercept=0) + 
  labs(y = "Residuals",
       x = " ")+
  theme_classic()

c <- qplot(fitted(RE), resid(RE))+ 
  geom_point(col = "Green")+
  geom_hline(yintercept=0) + 
  labs(y = "Residuals",
       x = " ")+
  theme_classic()

resíduos <- ggarrange(a,b,c, ncol = 1, nrow = 3)

ggarrange(gráfico,resíduos,  ncol = 2, nrow = 1, common.legend = TRUE, legend = "right")
```

### Longitude

#### Registros

```{r}
gráfico <- ggplot(LO, aes(x = FR, y = R, color = L1, alpha =I(.5)))+
  geom_point()+
  scale_colour_manual(values = c("red","blue", "green")) +
  stat_smooth(method = "lm",
              se = FALSE,
              fullrange = TRUE,
              size = 1)+
  labs( x ="Longitude (º)",
        y =  "Número de Registros (Log10)",
        colour = " ")+
  theme_classic()

REW <- lm(WAVRLO~LOWAVR, data = dados)
RES <- lm(SPLRLO~LOSPLR, data = dados)
RE <- lm(WAV2RLO~LOWAV2R, data = dados)

a <- qplot(fitted(REW), resid(REW))+ 
  geom_point(col = "blue")+
  geom_hline(yintercept=0) + 
  labs(y = "Residuals",
       x = " ")+
  theme_classic()

b <- qplot(fitted(RES), resid(RES))+ 
  geom_point(col = "Red")+
  geom_hline(yintercept=0) + 
  labs(y = "Residuals",
       x = " ")+
  theme_classic()

c <- qplot(fitted(RE), resid(RE))+ 
  geom_point(col = "Green")+
  geom_hline(yintercept=0) + 
  labs(y = "Residuals",
       x = " ")+
  theme_classic()

resíduos <- ggarrange(a,b,c, ncol = 1, nrow = 3)

ggarrange(gráfico,resíduos,  ncol = 2, nrow = 1, common.legend = TRUE, legend = "right")
```

#### Espécies

```{r}
gráfico <- ggplot(LO, aes(x = FE, y = E, color = L2, alpha =I(.5)))+
  geom_point()+
  scale_colour_manual(values = c("red", "blue", "green")) +
  stat_smooth(method = "lm",
              se = FALSE,
              fullrange = TRUE,
              size = 1)+
  labs( x ="Longitude (º)",
        y = "Número de Espécies (Log10)",
        colour = " ")+
  theme_classic()

REW <- lm(WAVELO~LOWAVE, data = dados)
RES <- lm(SPLELO~LOSPLE, data = dados)
RE <- lm(WAV2ELO~LOWAV2E, data = dados)

a <- qplot(fitted(REW), resid(REW))+ 
  geom_point(col = "blue")+
  geom_hline(yintercept=0) + 
  labs(y = "Residuals",
       x = " ")+
  theme_classic()

b <- qplot(fitted(RES), resid(RES))+ 
  geom_point(col = "Red")+
  geom_hline(yintercept=0) + 
  labs(y = "Residuals",
       x = " ")+
  theme_classic()

c <- qplot(fitted(RE), resid(RE))+ 
  geom_point(col = "Green")+
  geom_hline(yintercept=0) + 
  labs(y = "Residuals",
       x = " ")+
  theme_classic()

resíduos <- ggarrange(a,b,c, ncol = 1, nrow = 3)

ggarrange(gráfico,resíduos,  ncol = 2, nrow = 1, common.legend = TRUE, legend = "right")
```

```{r}
rm(list=ls())
```

# Seção 4

## Representação 1.1.

```{r}
dados <- read.xlsx ("C:/Users/bia99/OneDrive/Documents/Wikiaves/R/S4/WS.xlsx")
RW <- read.xlsx ("C:/Users/bia99/OneDrive/Documents/Wikiaves/R/S4/RW.xlsx")
RS <- read.xlsx ("C:/Users/bia99/OneDrive/Documents/Wikiaves/R/S4/RS.xlsx")
RW2 <- read.xlsx ("C:/Users/bia99/OneDrive/Documents/Wikiaves/R/S4/RW2.xlsx")
```

```{r}
gráfico <- ggplot(dados, aes(x = A2, y = A1))+
  geom_point()+
  stat_smooth(method = "lm",
              se = FALSE,
              fullrange = TRUE,
              col = "red",
              size = 1)+
  labs( x ="Número de Registros SpeciesLink (Log10)",
        y =  "Número de Registros Wikiaves (Log10)")+
  theme_classic()

A <- lm(A1~A2, data = dados)
summary(A)

R <- resid(A)

resíduos <- ggplot()+
  geom_histogram(aes (x = R,
                      y = stat(count) / sum(count)*100, 
                      #fill = I("blue"),
                      col = I("black"),
                      alpha = I(.5)),
                 bins = 25)+
  labs(y = "Frequência Relativa (%)",
       x = "Resíduos") +
  theme_classic()

ggarrange(gráfico,resíduos,  ncol = 2, nrow = 1)
```

```{r}
gráfico <- ggplot(dados, aes(x = B2, y = B1))+
  geom_point()+
  stat_smooth(method = "lm",
              se = FALSE,
              fullrange = TRUE,
              col = "red",
              size = 1)+
  labs( x ="Número de Espécies SpeciesLink (Log10)",
        y =  "Número de Espécies Wikiaves (Log10)")+
  theme_classic()

A <- lm(B1~B2, data = dados)
summary(A)

R <- resid(A)

resíduos <- ggplot()+
  geom_histogram(aes (x = R,
                      y = stat(count) / sum(count)*100, 
                      #fill = I("blue"),
                      col = I("black"),
                      alpha = I(.5)),
                 bins = 25)+
  labs(y = "Frequência Relativa (%)",
       x = "Resíduos") +
  theme_classic()

ggarrange(gráfico,resíduos,  ncol = 2, nrow = 1)
```

```{r}
gráfico <- ggplot(dados, aes(x = C1, y = C2, color = L1))+
  geom_point()+
  scale_colour_manual(values = c("red", "blue","green")) +
  stat_smooth(method = "lm",
              formula = y~poly(x,2),
              se = FALSE,
              fullrange = TRUE,
              size = 1)+
  labs( x ="Número de Registros (Log10)",
        y =  "Número de Espécies (Log10)",
        colour = " ")+
  theme_classic()

A <- lm(WE~poly(WR,2), data = RW)
summary(A)
B <- lm(SE~poly(SR,2), data = RS)
summary(B)
C <- lm(W2E~poly(W2R,2), data = RW2)
summary(C)
R1 <- resid (A)
R2 <- resid (B)
R3 <- resid (C)

resíduos <- ggplot()+
  geom_histogram(aes (x = R1,
                      y = stat(count) / sum(count)*100, 
                      fill = I("blue"),
                      col = I("black"),
                      alpha = I(.5)),
                 bins = 25)+
  geom_histogram(aes (x = R2,
                      y = stat(count) / sum(count)*100, 
                      fill = I("red"),
                      col = I("black"),
                      alpha = I(.5)),
                 bins = 25)+
  geom_histogram(aes (x = R3,
                      y = stat(count) / sum(count)*100, 
                      fill = I("green"),
                      col = I("black"),
                      alpha = I(.5)),
                 bins = 25) +
  labs(y = "Frequência Relativa (%)",
       x = "Resíduos") +
  theme_classic()

ggarrange(gráfico,resíduos,  ncol = 2, nrow = 1, common.legend = TRUE, legend = "right")
```

## Representação 1.2

```{r}
gráfico <- ggplot(dados, aes(x = A2, y = A1))+
  geom_point()+
  stat_smooth(method = "lm",
              se = FALSE,
              fullrange = TRUE,
              col = "red",
              size = 1)+
  labs( x ="Número de Registros SpeciesLink (Log10)",
        y =  "Número de Registros Wikiaves (Log10)")+
  theme_classic()

A <- lm(A1~A2, data = dados)

resíduos <- qplot(fitted(A), resid(A))+ 
  geom_point()+
  geom_hline(yintercept=0) + 
  labs(y = "Residuals",
       x = " ")+
  theme_classic()

ggarrange(gráfico,resíduos,  ncol = 2, nrow = 1, common.legend = TRUE, legend = "right")
```

```{r}
gráfico <- ggplot(dados, aes(x = B2, y = B1))+
  geom_point()+
  stat_smooth(method = "lm",
              se = FALSE,
              fullrange = TRUE,
              col = "red",
              size = 1)+
  labs( x ="Número de Espécies SpeciesLink (Log10)",
        y =  "Número de Espécies Wikiaves (Log10)")+
  theme_classic()

A <- lm(B1~B2, data = dados)

resíduos <- qplot(fitted(A), resid(A))+ 
  geom_point()+
  geom_hline(yintercept=0) + 
  labs(y = "Residuals",
       x = " ")+
  theme_classic()

ggarrange(gráfico,resíduos,  ncol = 2, nrow = 1, common.legend = TRUE, legend = "right")

```

```{r}
gráfico <- ggplot(dados, aes(x = C1, y = C2, color = L1))+
  geom_point()+
  scale_colour_manual(values = c("red", "blue","green")) +
  stat_smooth(method = "lm",
              formula = y~poly(x,2),
              se = FALSE,
              fullrange = TRUE,
              size = 1)+
  labs( x ="Número de Registros (Log10)",
        y =  "Número de Espécies (Log10)",
        colour = " ")+
  theme_classic()

A <- lm(WE~poly(WR,2), data = RW)
B <- lm(SE~poly(SR,2), data = RS)
C <- lm(W2E~poly(W2R,2), data = RW2)

a <- qplot(fitted(A), resid(A))+ 
  geom_point(col = "blue")+
  geom_hline(yintercept=0) + 
  labs(y = "Residuals",
       x = " ")+
  theme_classic()

b <- qplot(fitted(B), resid(B))+ 
  geom_point(col = "Red")+
  geom_hline(yintercept=0) + 
  labs(y = "Residuals",
       x = " ")+
  theme_classic()

c <- qplot(fitted(C), resid(C))+ 
  geom_point(col = "Green")+
  geom_hline(yintercept=0) + 
  labs(y = "Residuals",
       x = " ")+
  theme_classic()

resíduos <- ggarrange(a,b,c, ncol = 1, nrow = 3)

ggarrange(gráfico,resíduos,  ncol = 2, nrow = 1, common.legend = TRUE, legend = "right")

```

## Representação 2.1

```{r}
gráfico <- ggplot(dados, aes(x = C1, y = C2, color = L1, alpha =I(.5)))+
  geom_point()+
  scale_colour_manual(values = c("red", "blue","green")) +
  stat_smooth(method = "lm",
              formula = y~poly(x,2),
              se = FALSE,
              fullrange = TRUE,
              size = 1)+
  labs( x ="Número de Registros (Log10)",
        y =  "Número de Espécies (Log10)",
        colour = " ")+
  theme_classic()

A <- lm(WE~poly(WR,2), data = RW)
B <- lm(SE~poly(SR,2), data = RS)
C <- lm(W2E~poly(W2R,2), data = RW2)

R1 <- resid (A)
R2 <- resid (B)
R3 <- resid (C)

resíduos <- ggplot()+
  geom_histogram(aes (x = R1,
                      y = stat(count) / sum(count)*100, 
                      fill = I("blue"),
                      col = I("black"),
                      alpha = I(.5)),
                 bins = 25)+
  geom_histogram(aes (x = R2,
                      y = stat(count) / sum(count)*100, 
                      fill = I("red"),
                      col = I("black"),
                      alpha = I(.5)),
                 bins = 25)+
  geom_histogram(aes (x = R3,
                      y = stat(count) / sum(count)*100, 
                      fill = I("green"),
                      col = I("black"),
                      alpha = I(.5)),
                 bins = 25) +
  labs(y = "Frequência Relativa (%)",
       x = "Resíduos") +
  theme_classic()

ggarrange(gráfico,resíduos,  ncol = 2, nrow = 1, common.legend = TRUE, legend = "right")
```

## Representação 2.2

```{r}
gráfico <- ggplot(dados, aes(x = C1, y = C2, color = L1, alpha =I(.5)))+
  geom_point()+
  scale_colour_manual(values = c("red", "blue","green")) +
  stat_smooth(method = "lm",
              formula = y~poly(x,2),
              se = FALSE,
              fullrange = TRUE,
              size = 1)+
  labs( x ="Número de Registros (Log10)",
        y =  "Número de Espécies (Log10)",
        colour = " ")+
  theme_classic()

A <- lm(WE~poly(WR,2), data = RW)
B <- lm(SE~poly(SR,2), data = RS)
C <- lm(W2E~poly(W2R,2), data = RW2)

a <- qplot(fitted(A), resid(A))+ 
  geom_point(col = "blue")+
  geom_hline(yintercept=0) + 
  labs(y = "Residuals",
       x = " ")+
  theme_classic()

b <- qplot(fitted(B), resid(B))+ 
  geom_point(col = "Red")+
  geom_hline(yintercept=0) + 
  labs(y = "Residuals",
       x = " ")+
  theme_classic()

c <- qplot(fitted(C), resid(C))+ 
  geom_point(col = "Green")+
  geom_hline(yintercept=0) + 
  labs(y = "Residuals",
       x = " ")+
  theme_classic()

resíduos <- ggarrange(a,b,c, ncol = 1, nrow = 3)

ggarrange(gráfico,resíduos,  ncol = 2, nrow = 1, common.legend = TRUE, legend = "right")

```

# Seção 5

```{r}
Dados <- read.xlsx ("C:/Users/bia99/OneDrive/Documents/Wikiaves/R/S5/Mapas.xlsx")
FE <- read.xlsx ("C:/Users/bia99/OneDrive/Documents/Wikiaves/R/S5/Mapas2.xlsx")
mc <- read_municipality(code_muni= "SP")
```

```{r}
FAT <- merge(mc,FE)
cid <- merge(mc,Dados)
```

```{r}
FAT$AL <- cut(FAT$Altitude, breaks = c(0,200,400,600,800,1000,1200,1400,1600,Inf),
              labels = c("0-200","200-400","400-600","600-800","800-1000","1000-1200","1200-1400","1400-1600","1600+"))

FAT$AR <- cut(FAT$Area, breaks = c(0,250,500,750,1000,1250,1500,Inf), 
              labels = c("0-250","250-500","500-750","750-1000","1000-1250","1250-1500","1500+"))

FAT$POP <- cut(FAT$Populacao, breaks = c(0,1500000,300000,4500000,6000000,7500000,9000000,10500000,12000000,Inf), 
                labels = c("0 - 1.500.000","1.500.000 - 3.000.000","3.000.000 - 4.500.000" , "4.500.000 - 6.000.000","6.000.000 - 7.500.000","7.500.000 - 9.000.000", "9.000.000 - 10.500.000","10.500.000 - 12.000.000","12.000.000+"))

FAT$LAT <- cut(FAT$Latitude, breaks = c(-26,-25,-24,-23,-22,-21,-20,Inf), 
                labels = c("-26 a -25","-25 a -24","-24 a -23","-23 a -22","-22 a -21", "-21 a -20","-20+"))

FAT$LOG <- cut(FAT$Longitude, breaks = c(-55,-52.5,-50,-47.5,-45,Inf), 
                labels = c("-55 a -52.5","-52.5 a -50","-50 a -47.5","-47.5 a -45","-45 +"))

FAT$LAR <- cut(FAT$AreaL, breaks = c(0,0.5,1,1.5,2,2.5,3,3.5,4),
               labels = c("0 - 0.5","0.5 - 1", "1 - 1.5", "1.5 - 2", "2 - 2.5", "2.5 - 3", "3 - 3.5","3.5 - 4"))

FAT$LPOP <- cut (FAT$PopulacaoL, breaks = c(2,3,4,5,6,7,8), 
                 labels = c("2 - 3", "3 - 4", "4 - 5", "5 - 6", "6 - 7", "7+"))
```

## Altitude

```{r}
ggplot(FAT) +  
  geom_sf(aes(fill=AL), color = NA) + 
  labs(subtitle="", size=8)+ 
  scale_fill_manual (values = brewer.pal(9,'OrRd'))+  
  labs(fill = "Altitude (m) ")+  
  theme_minimal()
```

## Área

```{r}
ggplot(FAT) +
  geom_sf(aes(fill=LAR), color = NA) +
  labs(subtitle=" ", size=8)+  
  scale_fill_manual (values = brewer.pal(7,'OrRd'))+  
  labs(fill = "Área (Log10(km^2))")+  
  theme_minimal()
```

## População

```{r}
ggplot(FAT) + 
  geom_sf(aes(fill=LPOP), color = NA) + 
  labs(subtitle="", size=8)+   
  scale_fill_manual (values = brewer.pal(9,'OrRd'))+  
  labs(fill = "População (Log10)")+ 
  theme_minimal()
```

##Latitude

```{r}
ggplot(FAT) + 
  geom_sf(aes(fill=LAT), color = NA) + 
  labs(subtitle="", size=8)+  
  scale_fill_manual (values = brewer.pal(7,'OrRd'))+ 
  labs(fill = "Latitude (°) ")+ 
  theme_minimal()
```


##Longitude

```{r}
ggplot(FAT) + 
  geom_sf(aes(fill=LOG), color = NA) + 
  labs(subtitle="", size=8)+  
  scale_fill_manual (values = brewer.pal(6,'OrRd'))+ 
  labs(fill = "Longitude  (°)")+ 
  theme_minimal()
```


```{r}
cid$WEI <- cut(cid$WAVE, breaks = c(-1,0,100,200,300,400,Inf), 
               labels=c("0","1 a 100","101 a 200","201 a 300","301 a 400","401+"))

cid$SEI <- cut(cid$SPLE, breaks = c(-1,0,50,100,150,200,Inf),
               labels= c("0","1 a 50","51 a 100","101 a 150","151 a 200","201+"))

cid$WRI <- cut(cid$WAVR, breaks = c(-1,0,5000,10000,15000,20000,25000,30000,35000, Inf), 
               labels=c("0","1 a 5000","5001 a 10000","10001 a 15000","15001 a 20000","20001 a 25000","25001 a 30000", "30001 a 35000","35000+"))

cid$SRI <- cut(cid$SPLR, breaks = c(-1,0,800,1600,2400,3200,4000,4800,5600,Inf),
               labels= c("0","1 a 800","801 a 1600","1601 a 2400","2401 a 3200","3201 a 4000","4001 a 4800","4801 a 5600","5601+"))

cid$LWEI <- cut(cid$LWAVE, breaks = c(-2,-1,0,1.00,1.5,2.0,2.5,Inf),
                labels = c("Sem registro","0.00","0.01 a 1.00","1.01 a 1.50","1.51 a 2.00","2.01 a 2.50","2.51 a 3.00"))

cid$LSEI <- cut(cid$LSPLE, breaks = c(-2,-1,0,1.00,1.5,2.0,2.5,Inf),
                labels = c("Sem registro","0.00","0.01 a 1.00","1.01 a 1.50","1.51 a 2.00","2.01 a 2.50","2.51 a 3.00"))

cid$LWRI <- cut(cid$LWAVR, breaks = c(-2,-1,1.00,1.5,2.0,2.5,3.00,3.5,4,Inf),
                labels = c("Sem registro","0.00 a 1.00","1.01 a 1.50","1.51 a 2.00","2.01 a 2.50","2.51 a 3.00","3.01 a 3.50","3.51 a 4.00","4.01+"))

cid$LSRI <- cut(cid$LSPLR, breaks = c(-2,-1,1.00,1.5,2.0,2.5,3.00,3.5,4,Inf),
                labels = c("Sem registro","0.00 a 1.00","1.01 a 1.50","1.51 a 2.00","2.01 a 2.50","2.51 a 3.00","3.01 a 3.50","3.51 a 4.00","4.01+"))

cid$LW2EI <- cut(cid$LWAV2E, breaks = c(-2,-1,0,1.00,1.5,2.0,2.5,Inf),
                 labels = c("Sem registro","0.00","0.01 a 1.00","1.01 a 1.50","1.51 a 2.00","2.01 a 2.50","2.51 a 3.00"))

cid$LW2RI <- cut(cid$LWAV2R, breaks = c(-2,-1,1.00,1.5,2.0,2.5,3.00,3.5,4,Inf),
                 labels = c("Sem registro","0.00 a 1.00","1.01 a 1.50","1.51 a 2.00","2.01 a 2.50","2.51 a 3.00","3.01 a 3.50","3.51 a 4.00","4.01+"))

```

```{r}
A <- ggplot(cid) +
  geom_sf(aes(fill=LWEI), color = NA) +
  labs(subtitle="Wikiaves", size=8)+ 
  scale_fill_manual (values = c('#f0f0f0','#fdd49e','#fdbb84','#feb24c','#fc8d59','#ef6548','#d7301f'))+
  labs(fill = "Espécies (Log10) ")+
  theme_minimal()

B <- ggplot(cid) +
  geom_sf(aes(fill=LW2EI), color = NA) +
  labs(subtitle="Wikiaves 2", size=8)+ 
  scale_fill_manual (values = c('#f0f0f0','#fdd49e','#fdbb84','#feb24c','#fc8d59','#ef6548','#d7301f'))+
  labs(fill = "Espécies (Log10) ")+
  theme_minimal()


C <- ggplot(cid) +
  geom_sf(aes(fill=LSEI), color = NA) +
  labs(subtitle="SpeciesLink ", size=8)+ 
  scale_fill_manual (values = c('#f0f0f0','#fdd49e','#fdbb84','#feb24c','#fc8d59','#ef6548','#d7301f'))+
  labs(fill = "Espécies (Log10) ")+
  theme_minimal()


D <- ggplot(cid) +
  geom_sf(aes(fill=LSRI), color = NA) +
  labs(subtitle="SpeciesLink", size=8)+ 
  scale_fill_manual (values = c('#f0f0f0','#fdd49e','#fdbb84','#feb24c','#fc8d59','#ef6548','#d7301f','#b30000','#7f0000'))+
  labs(fill = "Registros (Log10) ")+
  theme_minimal()

E <- ggplot(cid) +
  geom_sf(aes(fill=LWRI), color = NA) +
  labs(subtitle="Wikiaves", size=8)+
  scale_fill_manual (values = c('#f0f0f0','#fdd49e','#fdbb84','#feb24c','#fc8d59','#ef6548','#d7301f','#b30000','#7f0000'))+
  labs(fill = "Registros (Log10) ")+
  theme_minimal()

G <- ggplot(cid) +
  geom_sf(aes(fill=LW2RI), color = NA) +
  labs(subtitle="Wikiaves 2", size=8)+
  scale_fill_manual (values = c('#f0f0f0','#fdd49e','#fdbb84','#feb24c','#fc8d59','#ef6548','#d7301f','#b30000','#7f0000'))+
  labs(fill = "Registros (Log10) ")+
  theme_minimal()

ggarrange(E,A,D,C,G,B, ncol = 2, nrow = 3)

```

# Seção 6

```{r}
WAV <- read.xlsx ("C:/Users/bia99/OneDrive/Documents/Wikiaves/R/S6/WAV-E.xlsx")
SPL <- read.xlsx ("C:/Users/bia99/OneDrive/Documents/Wikiaves/R/S6/SPL-E.xlsx")
```

```{r}
WAV <- t(WAV)
WAV <- WAV[-1,]
is.numeric(WAV)
SPL <- t(SPL)
SPL <- SPL[-1,]
is.numeric(SPL)
```

```{r}
A1 <- vegdist(WAV, method = "jaccard", binary = TRUE)
A2 <- dist.binary(WAV, method = "1")
A3 <- dist(WAV, method = "binary")
```

```{r}
B1 <- vegdist(SPL, method = "jaccard", binary = TRUE)
B2 <- dist.binary(SPL, method = "1")
B3 <- dist(SPL, method = "binary")
```

```{r}
fviz_dist(A1) + 
  scale_fill_gradient(low = "yellow", high = "red")
```

```{r}
fviz_dist(A2) + 
  scale_fill_gradient(low = "yellow", high = "red")
```

```{r}
fviz_dist(A3) + 
  scale_fill_gradient(low = "yellow", high = "red")
```

```{r}
fviz_dist(B1) + 
  scale_fill_gradient(low = "yellow", high = "red")
```

```{r}
fviz_dist(B2) + 
  scale_fill_gradient(low = "yellow", high = "red")
```

```{r}
fviz_dist(B3) + 
  scale_fill_gradient(low = "yellow", high = "red")
```

```{r}
X1 <- hclust(A1, "ward.D2")
fviz_dend(X1)
```

# Seção 7

```{r}
dados <- read.xlsx ("C:/Users/bia99/OneDrive/Documents/Wikiaves/R/S6/FE.xlsx")
```

```{r}
FE <- data.frame(dados[,6:10], row.names = dados$Cidades)
tFE <- t(FE)
```

```{r}
A <- cor(FE)
B <- cor(tFE)
```

```{r}
ggcorrplot(A,
           hc.order = TRUE,
           colors = c("blue", "white", "red"),
           lab = TRUE)
```

```{r}
Y <- dist(FE)
X <- hclust(Y, "ward.D2")
fviz_dend(X)
```

```{r}
FE <- data.frame(dados[,2:10], row.names = dados$Cidades)
A <- cor(FE)
```

```{r}
ggcorrplot(A,
           hc.order = TRUE,
           colors = c("blue", "white", "red"),
           lab = TRUE)
```

```{r}
B <- dist(FE)
X <- hclust(B, "ward.D2")
fviz_dend(X)
```

```{r}
K <- kmeans(FE, 2)
C <- cbind(K$cluster)
clusplot (FE, K$cluster, shade = TRUE, labels = 0)
```
